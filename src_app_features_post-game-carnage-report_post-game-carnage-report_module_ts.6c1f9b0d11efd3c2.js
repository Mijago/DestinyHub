"use strict";(self.webpackChunkD2Hub=self.webpackChunkD2Hub||[]).push([["src_app_features_post-game-carnage-report_post-game-carnage-report_module_ts"],{2483:(k,f,o)=>{o.r(f),o.d(f,{PostGameCarnageReportModule:()=>X});var m=o(6895),u=o(3797),C=o(1184),y=o(5861),h=o(9841),P=o(4482);const{isArray:R}=Array;function x(e){return 1===e.length&&R(e[0])?e[0]:e}var G=o(3268),Z=o(9635),A=o(3269);function v(...e){const n=(0,A.jO)(e);return n?(0,Z.z)(v(...e),(0,G.Z)(n)):(0,P.e)((a,r)=>{(0,h.l)([a,...x(e)])(r)})}function D(...e){return v(...e)}var T=o(6489),t=o(4650),U=o(4623),N=o(1109),c=o(3546),g=o(1576),i=o(671);function Y(e,n){if(1&e&&t._UZ(0,"div",13),2&e){const a=t.oxw(2);t.Udp("background-image","url(https://bungie.net/"+a.activity.displayProperties.icon+")")}}function j(e,n){1&e&&(t.TgZ(0,"mat-header-cell"),t._uU(1," Name "),t.qZA())}function I(e,n){if(1&e&&(t.TgZ(0,"mat-cell"),t._uU(1),t.qZA()),2&e){const a=n.$implicit;t.xp6(1),t.AsE(" ",a.player.destinyUserInfo.bungieGlobalDisplayName,"#",a.player.destinyUserInfo.bungieGlobalDisplayNameCode," ")}}function M(e,n){1&e&&(t.TgZ(0,"mat-header-cell"),t._uU(1," Kills "),t.qZA())}function S(e,n){if(1&e&&(t.TgZ(0,"mat-cell"),t._uU(1),t.ALo(2,"json"),t.qZA()),2&e){const a=n.$implicit;t.xp6(1),t.hij(" ",t.lcZ(2,1,a.values.kills.basic.value)," ")}}function b(e,n){if(1&e&&(t.TgZ(0,"mat-cell"),t._uU(1),t.qZA()),2&e){const a=n.$implicit;t.xp6(1),t.hij(" ",a.name," ")}}function z(e,n){1&e&&t._UZ(0,"mat-row")}function B(e,n){1&e&&t._UZ(0,"mat-row")}const Q=function(){return["groupHeader"]};function L(e,n){if(1&e&&(t.TgZ(0,"mat-card")(1,"mat-card-title-group"),t.YNc(2,Y,1,2,"div",3),t.TgZ(3,"mat-card-title"),t._uU(4),t.qZA(),t.TgZ(5,"mat-card-subtitle"),t._uU(6),t.ALo(7,"date"),t.qZA()(),t.TgZ(8,"mat-card-header",4),t._uU(9,"sad"),t.qZA(),t.TgZ(10,"mat-card-content")(11,"mat-table",5),t.ynx(12,6),t.YNc(13,j,2,0,"mat-header-cell",7),t.YNc(14,I,2,2,"mat-cell",8),t.BQk(),t.ynx(15,9),t.YNc(16,M,2,0,"mat-header-cell",7),t.YNc(17,S,3,3,"mat-cell",8),t.BQk(),t.ynx(18,10),t.YNc(19,b,2,1,"mat-cell",8),t.BQk(),t.YNc(20,z,1,0,"mat-row",11),t.YNc(21,B,1,0,"mat-row",12),t.qZA()()()),2&e){const a=t.oxw();t.xp6(2),t.Q6J("ngIf",a.activity.displayProperties.hasIcon),t.xp6(2),t.hij(" ",a.activity.displayProperties.name," "),t.xp6(2),t.hij(" Post Game Carnage Report - ",t.xi3(7,7,a.pgcrDate,"medium")," "),t.xp6(5),t.Q6J("dataSource",a.dataSource),t.xp6(9),t.Q6J("matRowDefColumns",a.displayedColumns),t.xp6(1),t.Q6J("matRowDefColumns",t.DdM(10,Q))("matRowDefWhen",a.isGroup)}}const H=[{path:"",component:C.$,children:[{path:":pgcr",component:(()=>{class e{constructor(a,r,l){this.bungieApi=a,this.manifest=r,this.activeRoute=l,this.displayedColumns=["name","kills"],this.pgcr=null,this.teams=[],this.activity=void 0,this.dataSource=[]}isGroup(a,r){return!!r.name}ngOnInit(){var a=this;this.activeRoute.params.pipe(D(this.manifest.ensureManifestTableExists("DestinyActivityDefinition"))).subscribe(function(){var r=(0,y.Z)(function*(l){var K=l[0].pgcr,V=yield a.bungieApi.getPostGameCarnageReport(K);a.pgcr=V.Response,a.activity=yield T.s.DestinyActivityDefinition.where("hash").equals(a.pgcr.activityDetails.directorActivityHash).first(),console.log("this.activity",a.activity);var d=[{name:"PvE",players:a.pgcr.entries}];a.pgcr.teams.length>1&&(d=a.pgcr.entries.reduce((s,p)=>(s[p.values.team.basic.value-18].players.push(p),s),[{name:"Alpha",players:[]},{name:"Bravo",players:[]}]));for(let s of d){a.dataSource.push(s);for(let p of s.players)a.dataSource.push(p)}a.teams=d});return function(l){return r.apply(this,arguments)}}())}get pgcrDate(){return this.pgcr?Date.parse(this.pgcr.period):""}}return e.\u0275fac=function(a){return new(a||e)(t.Y36(U.A),t.Y36(N.W),t.Y36(u.gz))},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-pgcrpage"]],decls:3,vars:1,consts:[["fxLayout","row","fxLayoutAlign","center none",1,"container"],["fxFlex","95%"],[4,"ngIf"],["mat-card-avatar","","style","background-size: cover;",3,"background-image",4,"ngIf"],["color","accent"],[1,"mat-elevation-z8",3,"dataSource"],["matColumnDef","name"],[4,"matHeaderCellDef"],[4,"matCellDef"],["matColumnDef","kills"],["matColumnDef","groupHeader"],[4,"matRowDef","matRowDefColumns"],[4,"matRowDef","matRowDefColumns","matRowDefWhen"],["mat-card-avatar","",2,"background-size","cover"]],template:function(a,r){1&a&&(t.TgZ(0,"div",0)(1,"div",1),t.YNc(2,L,22,11,"mat-card",2),t.qZA()()),2&a&&(t.xp6(2),t.Q6J("ngIf",null!=r.pgcr&&null!=r.activity))},dependencies:[m.O5,c.a8,c.dk,c.C1,c.dn,c.n5,c.$j,c.kc,g.xw,g.Wh,g.yH,i.BZ,i.fO,i.w1,i.Dz,i.nj,i.ge,i.ev,i.Gk,m.Ts,m.uU]}),e})()},{path:"**",component:(()=>{class e{constructor(){}ngOnInit(){}}return e.\u0275fac=function(a){return new(a||e)},e.\u0275cmp=t.Xpm({type:e,selectors:[["app-pgcrerror-page"]],decls:2,vars:0,template:function(a,r){1&a&&(t.TgZ(0,"p"),t._uU(1,"pgcrerror-page works!"),t.qZA())}}),e})()}]}];let J=(()=>{class e{}return e.\u0275fac=function(a){return new(a||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[u.Bz.forChild(H),u.Bz]}),e})();var w=o(5823),W=o(7392),F=o(3683),$=o(6338);let X=(()=>{class e{}return e.\u0275fac=function(a){return new(a||e)},e.\u0275mod=t.oAB({type:e}),e.\u0275inj=t.cJS({imports:[m.ez,J,c.QW,w.o9,W.Ps,F.g0,$.ie,i.p0]}),e})()}}]);