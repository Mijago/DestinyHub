(self.webpackChunkD2Hub=self.webpackChunkD2Hub||[]).push([["src_app_features_trials-data-report_trials-data-report_module_ts"],{3540:(Pe,ye,O)=>{"use strict";O.r(ye),O.d(ye,{TrialsDataReportModule:()=>Ae});var De=O(6895),ae=O(3797),te=O(1184),X=O(5861),L=O(3905),z=O(7009),i=O(4650);let Q=(()=>{class v{constructor(u){this.data=u}ngOnInit(){}}return v.\u0275fac=function(u){return new(u||v)(i.Y36(z.qD))},v.\u0275cmp=i.Xpm({type:v,selectors:[["app-progress-toast"]],decls:1,vars:1,template:function(u,h){1&u&&i._uU(0),2&u&&i.hij("",h.data,"\n")}}),v})();var E=O(7340),re=O(4424),m=O(529);let y=(()=>{class v{constructor(u){this.http=u}getApiData(u){return this.http.get("https://api.trialsofthenine.com/weeks/"+u)}getMostRecent(){return this.getApiData(0)}}return v.\u0275fac=function(u){return new(u||v)(i.LFG(m.eN))},v.\u0275prov=i.Yz7({token:v,factory:v.\u0275fac,providedIn:"root"}),v})();var U=O(7392),P=O(3546),H=O(1576),N=O(2054);let oe=(()=>{class v{constructor(){this.subclassData=[],this.chartOption={tooltip:{trigger:"item",confine:!0,formatter:u=>{let h=u.data;var A=(100*h.percent).toFixed(1);return isNaN(h.percent)?`Total: ${h.value.toLocaleString()}`:`${h.name}: ${h.value.toLocaleString()} (${A}%)`}},title:{},series:[{data:[],type:"sunburst",center:["48%","55%"],radius:[0,"90%"],label:{rotate:"radial"}}]}}isHunter(u){return["Gunslinger","Revenant","Arcstrider","Nightstalker"].indexOf(u.name)>-1}isWarlock(u){return["Dawnblade","Shadebinder","Stormcaller","Voidwalker"].indexOf(u.name)>-1}isTitan(u){return["Sunbreaker","Behemoth","Striker","Sentinel"].indexOf(u.name)>-1}ngOnChanges(u){var h=this.subclassData.filter(b=>this.isHunter(b)),A=this.subclassData.filter(b=>this.isWarlock(b)),B=this.subclassData.filter(b=>this.isTitan(b)),D=h.reduce((b,$)=>b+$.amount,0),k=A.reduce((b,$)=>b+$.amount,0),ee=B.reduce((b,$)=>b+$.amount,0),G=D+ee+k;this.chartOption.series[0].data=[{name:"Hunter",children:h.map(b=>({name:b.name,value:b.amount,itemStyle:{color:"#77afc0"},percent:b.amount/D})),itemStyle:{color:"#5f9cbb"},percent:D/G},{name:"Warlock",children:A.map(b=>({name:b.name,value:b.amount,itemStyle:{color:"#bdb177"},percent:b.amount/k})),itemStyle:{color:"#d7c16e"},percent:k/G},{name:"Titan",children:B.map(b=>({name:b.name,value:b.amount,itemStyle:{color:"#bd7777"},percent:b.amount/ee})),itemStyle:{color:"#b76262"},percent:ee/G}]}ngOnInit(){}}return v.\u0275fac=function(u){return new(u||v)},v.\u0275cmp=i.Xpm({type:v,selectors:[["app-class-and-subclass-chart"]],inputs:{subclassData:"subclassData"},features:[i.TTD],decls:1,vars:1,consts:[["echarts","",1,"demo-chart",3,"options"]],template:function(u,h){1&u&&i._UZ(0,"div",0),2&u&&i.Q6J("options",h.chartOption)},dependencies:[N._w]}),v})(),W=(()=>{class v{constructor(){this.weeks=[],this.overwrite={series:[{},{},{}]},this.chartOption={tooltip:{trigger:"axis",confine:!0},legend:{type:"scroll",textStyle:{color:"white"},show:!0},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:[{type:"time",boundaryGap:!1}],yAxis:[{alignTicks:!0,type:"value",max:100,min:0}],series:[{name:"Hunter",type:"line",stack:"Total",color:"#5f9cbb",areaStyle:{},emphasis:{focus:"series"},data:[]},{name:"Titan",type:"line",stack:"Total",color:"#b76262",areaStyle:{},emphasis:{focus:"series"},data:[]},{name:"Warlock",type:"line",stack:"Total",color:"#b6b45c",areaStyle:{},emphasis:{focus:"series"},data:[]}]}}isHunter(u){return["Gunslinger","Revenant","Arcstrider","Nightstalker"].indexOf(u.name)>-1}isWarlock(u){return["Dawnblade","Shadebinder","Stormcaller","Voidwalker"].indexOf(u.name)>-1}isTitan(u){return["Sunbreaker","Behemoth","Striker","Sentinel"].indexOf(u.name)>-1}ngOnInit(){}ngOnChanges(u){if(0!=this.weeks.length){var h=[],A=[],B=[];for(let J of this.weeks){var D=new Date(Date.parse(J.startDate)),k=[D.getFullYear(),D.getMonth()+1,D.getDate()].join("/"),ee=J.subclass.filter(V=>this.isHunter(V)),G=J.subclass.filter(V=>this.isWarlock(V)),b=J.subclass.filter(V=>this.isTitan(V)),$=ee.reduce((V,w)=>V+w.amount,0),ce=G.reduce((V,w)=>V+w.amount,0),fe=b.reduce((V,w)=>V+w.amount,0),se=$+ce+fe;0!=se&&(h.push([k,($/se*100).toFixed(2)]),A.push([k,(fe/se*100).toFixed(2)]),B.push([k,(ce/se*100).toFixed(2)]))}this.overwrite.series[0].data=h,this.overwrite.series[1].data=A,this.overwrite.series[2].data=B,this.overwrite=Object.assign({},this.overwrite)}}}return v.\u0275fac=function(u){return new(u||v)},v.\u0275cmp=i.Xpm({type:v,selectors:[["app-class-and-subclass-timeline-chart"]],inputs:{weeks:"weeks"},features:[i.TTD],decls:1,vars:2,consts:[["echarts","",1,"demo-chart",3,"options","merge"]],template:function(u,h){1&u&&i._UZ(0,"div",0),2&u&&i.Q6J("options",h.chartOption)("merge",h.overwrite)},dependencies:[N._w]}),v})();O(4734);let ue=(()=>{class v{constructor(){this.weeks=[],this.overwrite={},this.chartOption={tooltip:{trigger:"axis"},legend:{textStyle:{color:"white"},show:!0,type:"scroll"},grid:{left:"3%",right:"4%",bottom:"12%",top:"12%",containLabel:!0},xAxis:[{type:"time",boundaryGap:!1}],darkMode:!0,dataZoom:[{type:"inside"},{type:"slider"}],yAxis:[{alignTicks:!0,boundaryGap:!1,type:"value",max:100,min:0}],series:[]}}ngOnInit(){}ngOnChanges(u){if(0!=this.weeks.length){var h={};for(let G of this.weeks){var A=G.platforms[0].weaponTypes.filter(b=>"NULL"!=b.weaponType).reduce((b,$)=>b+$.kills,0);for(let b of G.platforms[0].weaponTypes){if("NULL"==b.weaponType)continue;null==h[b.weaponType]&&(h[b.weaponType]={name:b.weaponType,type:"line",smooth:!0,stack:"Total",areaStyle:{},emphasis:{focus:"series",blurScope:"coordinateSystem"},data:[]});var B=new Date(Date.parse(G.startDate)),D=[B.getFullYear(),B.getMonth()+1,B.getDate()].join("/");let $=+(b.kills/A*100).toFixed(2);h[b.weaponType].data.push([D,$])}}var k=new Date(Date.parse(this.weeks[10].startDate)-36e3),ee=[k.getFullYear(),k.getMonth()+1,k.getDate()].join("/");this.overwrite={dataZoom:[{startValue:ee}],series:Object.values(h)}}}}return v.\u0275fac=function(u){return new(u||v)},v.\u0275cmp=i.Xpm({type:v,selectors:[["app-weapon-usage-chart"]],inputs:{weeks:"weeks"},features:[i.TTD],decls:1,vars:2,consts:[["echarts","",1,"demo-chart",3,"options","merge"]],template:function(u,h){1&u&&i._UZ(0,"div",0),2&u&&i.Q6J("options",h.chartOption)("merge",h.overwrite)},dependencies:[N._w],styles:[".demo-chart[_ngcontent-%COMP%]{height:450px}"]}),v})();var p=O(6489),T=O(1109);let x=(()=>{class v{constructor(u){this.manifest=u,this.overwrite={series:[{}]},this.chartOption={title:{},tooltip:{trigger:"item",confine:!0,formatter:h=>{let A=h.data;var B=(100*A.percent).toFixed(1);return isNaN(A.percent)?`Total: ${A.value.toLocaleString()}`:`${A.name}: ${A.value.toLocaleString()} (${B}%)`}},series:[{data:[],type:"sunburst",center:["48%","55%"],labelLayout:{hideOverlap:!0},label:{overflow:"truncate",rotate:"radial"},levels:[{},{radius:[0,"30%"]},{radius:["30%","90%"]}]}]}}ngOnInit(){}ngOnChanges(u){var h=this;return(0,X.Z)(function*(){yield(0,L.z)(h.manifest.ensureManifestTableExists("DestinyInventoryItemDefinition"));var B=h.week.armor.map(function(){var w=(0,X.Z)(function*(F){return{armor:F,cls:(yield p.s.DestinyInventoryItemDefinition.where("hash").equals(Number.parseInt(F.hash)).first())?.classType}});return function(F){return w.apply(this,arguments)}}()),D=yield Promise.all(B),ee=D.filter(w=>0==w.cls).sort((w,F)=>F.armor.amount-w.armor.amount),G=D.filter(w=>2==w.cls).sort((w,F)=>F.armor.amount-w.armor.amount),b=D.filter(w=>1==w.cls).sort((w,F)=>F.armor.amount-w.armor.amount),$=b.reduce((w,F)=>w+F.armor.amount,0),ce=G.reduce((w,F)=>w+F.armor.amount,0),fe=ee.reduce((w,F)=>w+F.armor.amount,0),se=$+fe+ce,J=(w,F)=>w.reduce((le,me)=>(le.count/F>.8?le.data[0].armor.amount+=me.armor.amount:(le.data.push(me),le.count+=me.armor.amount),le),{data:[{cls:void 0,armor:{amount:0,name:"Others"}}],count:0}).data;b=J(b,$),G=J(G,ce),ee=J(ee,fe);var V=[{name:"Hunter",children:b.map(w=>({name:w.armor.name,value:w.armor.amount,itemStyle:{color:"#77afc0"},percent:w.armor.amount/$})),itemStyle:{color:"#5f9cbb"},percent:$/se},{name:"Warlock",children:G.map(w=>({name:w.armor.name,value:w.armor.amount,itemStyle:{color:"#bdb177"},percent:w.armor.amount/ce})),itemStyle:{color:"#d7c16e"},percent:ce/se},{name:"Titan",children:ee.map(w=>({name:w.armor.name,value:w.armor.amount,itemStyle:{color:"#bd7777"},percent:w.armor.amount/fe})),itemStyle:{color:"#b76262"},percent:fe/se}];h.overwrite={series:[{data:V}]}})()}}return v.\u0275fac=function(u){return new(u||v)(i.Y36(T.W))},v.\u0275cmp=i.Xpm({type:v,selectors:[["app-exotic-armor-usage-pie-chart"]],inputs:{week:"week"},features:[i.TTD],decls:1,vars:2,consts:[["echarts","",1,"demo-chart",3,"options","merge"]],template:function(u,h){1&u&&i._UZ(0,"div",0),2&u&&i.Q6J("options",h.chartOption)("merge",h.overwrite)},dependencies:[N._w]}),v})(),R=(()=>{class v{constructor(){this.week=null,this.overwrite={},this.chartOption={tooltip:{trigger:"item",confine:!0,formatter:u=>{let h=u.data;var A=(100*h.percent).toFixed(1);return`${h.name}: ${h.value.toLocaleString()} (${A}%)`}},series:{data:[],type:"pie",radius:[0,"100%"],labelLayout:{hideOverlap:!0},label:{position:"inside",overflow:"truncate",rotate:"radial"}}}}ngOnInit(){}ngOnChanges(u){var h=this;return(0,X.Z)(function*(){if(h.week){var A=h.week.platforms[0].weaponTypes.reduce((D,k)=>D+k.kills,0),B=h.week.platforms[0].weaponTypes.map(D=>({name:D.weaponType,value:D.kills,percent:D.kills/A,precisionRatio:D.headshots/D.kills})).sort((D,k)=>k.value-D.value);console.log("data",B),h.overwrite={series:{data:B}}}else h.overwrite={}})()}}return v.\u0275fac=function(u){return new(u||v)},v.\u0275cmp=i.Xpm({type:v,selectors:[["app-weapon-usage-pie-chart"]],inputs:{week:"week"},features:[i.TTD],decls:1,vars:2,consts:[["echarts","",1,"demo-chart",3,"options","merge"]],template:function(u,h){1&u&&i._UZ(0,"div",0),2&u&&i.Q6J("options",h.chartOption)("merge",h.overwrite)},dependencies:[N._w]}),v})();function Y(v,_){1&v&&(i.TgZ(0,"div",0)(1,"div",5)(2,"mat-icon"),i._uU(3,"dashboard"),i.qZA(),i.TgZ(4,"p"),i._uU(5,"Loading trials information..."),i.qZA()(),i._UZ(6,"mat-icon"),i.qZA())}function j(v,_){if(1&v&&(i.TgZ(0,"div",6)(1,"div",7)(2,"mat-card")(3,"mat-card-title-group")(4,"mat-card-title"),i._uU(5," Trials Subclass usage "),i.qZA(),i.TgZ(6,"mat-card-subtitle"),i._uU(7),i.qZA()(),i._UZ(8,"app-class-and-subclass-chart",8),i.qZA()(),i.TgZ(9,"div",7)(10,"mat-card")(11,"mat-card-title-group")(12,"mat-card-title"),i._uU(13," Trials Exotic armor Usage "),i.qZA(),i.TgZ(14,"mat-card-subtitle"),i._uU(15),i.qZA()(),i._UZ(16,"app-exotic-armor-usage-pie-chart",9),i.qZA()()()),2&v){const u=i.oxw();i.xp6(1),i.Q6J("@fade",void 0),i.xp6(6),i.hij(" Week ",u.week," "),i.xp6(1),i.Q6J("subclassData",u.trialsReportData.subclass),i.xp6(1),i.Q6J("@fade",void 0),i.xp6(6),i.hij(" Week ",u.week," "),i.xp6(1),i.Q6J("week",u.trialsReportData)}}function K(v,_){if(1&v&&(i.TgZ(0,"div",10)(1,"div",7)(2,"mat-card")(3,"mat-card-title-group")(4,"mat-card-title"),i._uU(5," Trials Class distribution over time "),i.qZA(),i.TgZ(6,"mat-card-subtitle"),i._uU(7),i.qZA()(),i._UZ(8,"app-class-and-subclass-timeline-chart",11),i.qZA()(),i.TgZ(9,"div",7)(10,"mat-card")(11,"mat-card-title-group")(12,"mat-card-title"),i._uU(13," Trials Weapon Type Usage "),i.qZA(),i.TgZ(14,"mat-card-subtitle"),i._uU(15),i.qZA()(),i._UZ(16,"app-weapon-usage-pie-chart",9),i.qZA()()()),2&v){const u=i.oxw();i.xp6(1),i.Q6J("@fade",void 0)("@fade",void 0),i.xp6(6),i.hij(" Weeks 114 to ",u.week," "),i.xp6(1),i.Q6J("weeks",u.previousWeeks),i.xp6(1),i.Q6J("@fade",void 0),i.xp6(6),i.hij(" Week ",u.week," "),i.xp6(1),i.Q6J("week",u.trialsReportData)}}function q(v,_){if(1&v&&(i.TgZ(0,"div",10)(1,"div",12)(2,"mat-card")(3,"mat-card-title-group")(4,"mat-card-title"),i._uU(5," Trials Weapon Type usage over time "),i.qZA(),i.TgZ(6,"mat-card-subtitle"),i._uU(7),i.qZA()(),i._UZ(8,"app-weapon-usage-chart",11),i.qZA()()()),2&v){const u=i.oxw();i.xp6(1),i.Q6J("@fade",void 0),i.xp6(6),i.hij(" Weeks 1 to ",u.week," "),i.xp6(1),i.Q6J("weeks",u.previousWeeks)}}function ie(v,_){1&v&&(i.TgZ(0,"div",10)(1,"div",12)(2,"mat-card")(3,"mat-card-title-group")(4,"mat-card-title"),i._uU(5,"Trials Statistics"),i.qZA(),i.TgZ(6,"mat-card-subtitle"),i._uU(7," Data provided by "),i.TgZ(8,"a",13),i._uU(9,"Trials.Report"),i.qZA(),i._uU(10,". "),i.qZA()()()()())}const he=[{path:"",component:te.$,children:[{path:"",component:(()=>{class v{constructor(u,h){this.trialsReportApi=u,this._snackBar=h,this.updateStatus={isUpdating:!1,weeksToUpdate:0,updatingWeek:0},this.week=-1,this.previousWeeks=[],this.trialsReportData=void 0,this.db=re.createInstance({name:"trials-report",storeName:"trials-report"})}ngOnInit(){var u=this;return(0,X.Z)(function*(){u.trialsReportData=yield(0,L.z)(u.trialsReportApi.getMostRecent()),console.log(u.trialsReportData),u.week=u.trialsReportData.weekNumber;var h=u._snackBar.openFromComponent(Q,{data:"",horizontalPosition:"right",verticalPosition:"top"});u.updateStatus.weeksToUpdate=u.week-1,u.updateStatus.updatingWeek=0,u.updateStatus.isUpdating=!0;var A=[];for(let D=u.week-1;D>=1;D--)A.push(u.getWeek(D).then(k=>(u.updateStatus.updatingWeek++,h.instance.data=`Fetching Trials data (${u.updateStatus.updatingWeek} of ${u.updateStatus.weeksToUpdate})`,k)));var B=yield Promise.all(A);u.updateStatus.isUpdating=!1,h.dismiss(),console.log("this.trialsReportData",u.trialsReportData),u.previousWeeks=[u.trialsReportData].concat(B)})()}getWeek(u){var h=this;return(0,X.Z)(function*(){let A="trialsreport-week-"+u;null!=localStorage.getItem(A)&&localStorage.removeItem(A);var B=yield h.db.getItem(A).then(k=>k?JSON.parse(k):null);if(null!=B)return B;const D=yield(0,L.z)(h.trialsReportApi.getApiData(u));return yield h.db.setItem(A,JSON.stringify(D)),D})()}}return v.\u0275fac=function(u){return new(u||v)(i.Y36(y),i.Y36(z.ux))},v.\u0275cmp=i.Xpm({type:v,selectors:[["app-trials-data-report"]],decls:7,vars:5,consts:[["fxLayout","row","fxLayoutAlign","center none",1,"container"],["fxFlex","95%"],["class","container","fxLayout","row","fxLayoutAlign","center none",4,"ngIf"],["class","container","fxLayout","row","fxLayout.sm","column","fxLayout.xs","column","fxLayoutAlign","center none","fxLayoutGap","15px",4,"ngIf"],["class","container","fxLayout","row","fxLayout.sm","column","fxLayout.xs","column","fxLayoutAlign","center none","fxLayoutGap","5px",4,"ngIf"],["fxFlex","50%",1,"text-center","no-records","animate"],["fxLayout","row","fxLayout.sm","column","fxLayout.xs","column","fxLayoutAlign","center none","fxLayoutGap","15px",1,"container"],["fxFlex","50%","fxFlex.gt-lg","50%","fxFlex.sm","100%","fxFlex.xs","100%"],["mat-card-image","",3,"subclassData"],[3,"week"],["fxLayout","row","fxLayout.sm","column","fxLayout.xs","column","fxLayoutAlign","center none","fxLayoutGap","5px",1,"container"],[3,"weeks"],["fxFlex","100%","fxFlex.gt-lg","100%","fxFlex.sm","100%","fxFlex.xs","100%"],["href","https://trials.report",1,"accent-color"]],template:function(u,h){1&u&&(i.TgZ(0,"div",0)(1,"div",1),i.YNc(2,Y,7,0,"div",2),i.YNc(3,j,17,6,"div",3),i.YNc(4,K,17,7,"div",4),i.YNc(5,q,9,3,"div",4),i.YNc(6,ie,11,0,"div",4),i.qZA()()),2&u&&(i.xp6(2),i.Q6J("ngIf",-1==h.week),i.xp6(1),i.Q6J("ngIf",h.trialsReportData),i.xp6(1),i.Q6J("ngIf",h.trialsReportData),i.xp6(1),i.Q6J("ngIf",h.trialsReportData),i.xp6(1),i.Q6J("ngIf",h.trialsReportData))},dependencies:[De.O5,U.Hw,P.a8,P.C1,P.n5,P.$j,P.G2,H.xw,H.SQ,H.Wh,H.yH,oe,W,ue,x,R],styles:[".theme-titan[_ngcontent-%COMP%]   .pageHeader[_ngcontent-%COMP%]{background-color:#d32f2f}  .theme-titan .pageHeader{background-color:#d32f2f}.theme-warlock[_ngcontent-%COMP%]   .pageHeader[_ngcontent-%COMP%]{background-color:#ffa000}  .theme-warlock .pageHeader{background-color:#ffa000}.theme-hunter[_ngcontent-%COMP%]   .pageHeader[_ngcontent-%COMP%]{background-color:#1976d2}  .theme-hunter .pageHeader{background-color:#1976d2}mat-card[_ngcontent-%COMP%]{margin-bottom:5px}.container1[_ngcontent-%COMP%]{font-size:16px;font-family:Roboto,Helvetica Neue,sans-serif}.chart-container[_ngcontent-%COMP%]{border-radius:5px;border:1px solid rgba(255,255,255,.2)}"],data:{animation:[(0,E.X$)("fade",[(0,E.eR)(":enter",[(0,E.oB)({opacity:0}),(0,E.jt)(300,(0,E.oB)({opacity:1}))]),(0,E.eR)(":leave",[(0,E.oB)({opacity:1}),(0,E.jt)(300,(0,E.oB)({opacity:0}))])])]}}),v})()}]}];let be=(()=>{class v{}return v.\u0275fac=function(u){return new(u||v)},v.\u0275mod=i.oAB({type:v}),v.\u0275inj=i.cJS({imports:[ae.Bz.forChild(he),ae.Bz]}),v})();var de=O(5823),Se=O(479);let Ae=(()=>{class v{}return v.\u0275fac=function(u){return new(u||v)},v.\u0275mod=i.oAB({type:v}),v.\u0275inj=i.cJS({providers:[y],imports:[De.ez,Se.S,be,de.o9,N.Ns.forRoot({echarts:()=>Promise.resolve().then(O.bind(O,4734))})]}),v})()},4424:Pe=>{Pe.exports=function ae(te,X,L){function z(E,re){if(!X[E]){if(!te[E]){if(i)return i(E,!0);var y=new Error("Cannot find module '"+E+"'");throw y.code="MODULE_NOT_FOUND",y}var U=X[E]={exports:{}};te[E][0].call(U.exports,function(P){return z(te[E][1][P]||P)},U,U.exports,ae,te,X,L)}return X[E].exports}for(var i=void 0,Q=0;Q<L.length;Q++)z(L[Q]);return z}({1:[function(ae,te,X){(function(L){"use strict";var i,z=L.MutationObserver||L.WebKitMutationObserver;if(z){var Q=0,E=new z(P),re=L.document.createTextNode("");E.observe(re,{characterData:!0}),i=function(){re.data=Q=++Q%2}}else if(!L.setImmediate&&typeof L.MessageChannel<"u"){var m=new L.MessageChannel;m.port1.onmessage=P,i=function(){m.port2.postMessage(0)}}else i="document"in L&&"onreadystatechange"in L.document.createElement("script")?function(){var N=L.document.createElement("script");N.onreadystatechange=function(){P(),N.onreadystatechange=null,N.parentNode.removeChild(N),N=null},L.document.documentElement.appendChild(N)}:function(){setTimeout(P,0)};var y,U=[];function P(){y=!0;for(var N,oe,W=U.length;W;){for(oe=U,U=[],N=-1;++N<W;)oe[N]();W=U.length}y=!1}te.exports=function H(N){1===U.push(N)&&!y&&i()}}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(ae,te,X){"use strict";var L=ae(1);function z(){}var i={},Q=["REJECTED"],E=["FULFILLED"],re=["PENDING"];function m(p){if("function"!=typeof p)throw new TypeError("resolver must be a function");this.state=re,this.queue=[],this.outcome=void 0,p!==z&&H(this,p)}function y(p,T,x){this.promise=p,"function"==typeof T&&(this.onFulfilled=T,this.callFulfilled=this.otherCallFulfilled),"function"==typeof x&&(this.onRejected=x,this.callRejected=this.otherCallRejected)}function U(p,T,x){L(function(){var R;try{R=T(x)}catch(Y){return i.reject(p,Y)}R===p?i.reject(p,new TypeError("Cannot resolve promise with itself")):i.resolve(p,R)})}function P(p){var T=p&&p.then;if(p&&("object"==typeof p||"function"==typeof p)&&"function"==typeof T)return function(){T.apply(p,arguments)}}function H(p,T){var x=!1;function R(q){x||(x=!0,i.reject(p,q))}function Y(q){x||(x=!0,i.resolve(p,q))}var K=N(function j(){T(Y,R)});"error"===K.status&&R(K.value)}function N(p,T){var x={};try{x.value=p(T),x.status="success"}catch(R){x.status="error",x.value=R}return x}te.exports=m,m.prototype.catch=function(p){return this.then(null,p)},m.prototype.then=function(p,T){if("function"!=typeof p&&this.state===E||"function"!=typeof T&&this.state===Q)return this;var x=new this.constructor(z);return this.state!==re?U(x,this.state===E?p:T,this.outcome):this.queue.push(new y(x,p,T)),x},y.prototype.callFulfilled=function(p){i.resolve(this.promise,p)},y.prototype.otherCallFulfilled=function(p){U(this.promise,this.onFulfilled,p)},y.prototype.callRejected=function(p){i.reject(this.promise,p)},y.prototype.otherCallRejected=function(p){U(this.promise,this.onRejected,p)},i.resolve=function(p,T){var x=N(P,T);if("error"===x.status)return i.reject(p,x.value);var R=x.value;if(R)H(p,R);else{p.state=E,p.outcome=T;for(var Y=-1,j=p.queue.length;++Y<j;)p.queue[Y].callFulfilled(T)}return p},i.reject=function(p,T){p.state=Q,p.outcome=T;for(var x=-1,R=p.queue.length;++x<R;)p.queue[x].callRejected(T);return p},m.resolve=function oe(p){return p instanceof this?p:i.resolve(new this(z),p)},m.reject=function W(p){var T=new this(z);return i.reject(T,p)},m.all=function xe(p){var T=this;if("[object Array]"!==Object.prototype.toString.call(p))return this.reject(new TypeError("must be an array"));var x=p.length,R=!1;if(!x)return this.resolve([]);for(var Y=new Array(x),j=0,K=-1,q=new this(z);++K<x;)ie(p[K],K);return q;function ie(pe,he){T.resolve(pe).then(function be(de){Y[he]=de,++j===x&&!R&&(R=!0,i.resolve(q,Y))},function(de){R||(R=!0,i.reject(q,de))})}},m.race=function ue(p){var T=this;if("[object Array]"!==Object.prototype.toString.call(p))return this.reject(new TypeError("must be an array"));var x=p.length,R=!1;if(!x)return this.resolve([]);for(var Y=-1,j=new this(z);++Y<x;)T.resolve(p[Y]).then(function(ie){R||(R=!0,i.resolve(j,ie))},function(ie){R||(R=!0,i.reject(j,ie))});return j}},{1:1}],3:[function(ae,te,X){(function(L){"use strict";"function"!=typeof L.Promise&&(L.Promise=ae(2))}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(ae,te,X){"use strict";var L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var Q=function i(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}();function re(e,r){e=e||[],r=r||{};try{return new Blob(e,r)}catch(n){if("TypeError"!==n.name)throw n;for(var a=new(typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder),o=0;o<e.length;o+=1)a.append(e[o]);return a.getBlob(r.type)}}typeof Promise>"u"&&ae(3);var m=Promise;function y(e,r){r&&e.then(function(t){r(null,t)},function(t){r(t)})}function U(e,r,t){"function"==typeof r&&e.then(r),"function"==typeof t&&e.catch(t)}function P(e){return"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}function H(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var N="local-forage-detect-blob-support",oe=void 0,W={},xe=Object.prototype.toString,ue="readonly",p="readwrite";function T(e){for(var r=e.length,t=new ArrayBuffer(r),a=new Uint8Array(t),o=0;o<r;o++)a[o]=e.charCodeAt(o);return t}function R(e){return"boolean"==typeof oe?m.resolve(oe):function x(e){return new m(function(r){var t=e.transaction(N,p),a=re([""]);t.objectStore(N).put(a,"key"),t.onabort=function(o){o.preventDefault(),o.stopPropagation(),r(!1)},t.oncomplete=function(){var o=navigator.userAgent.match(/Chrome\/(\d+)/),n=navigator.userAgent.match(/Edge\//);r(n||!o||parseInt(o[1],10)>=43)}}).catch(function(){return!1})}(e).then(function(r){return oe=r})}function Y(e){var r=W[e.name],t={};t.promise=new m(function(a,o){t.resolve=a,t.reject=o}),r.deferredOperations.push(t),r.dbReady=r.dbReady?r.dbReady.then(function(){return t.promise}):t.promise}function j(e){var t=W[e.name].deferredOperations.pop();if(t)return t.resolve(),t.promise}function K(e,r){var a=W[e.name].deferredOperations.pop();if(a)return a.reject(r),a.promise}function q(e,r){return new m(function(t,a){if(W[e.name]=W[e.name]||{forages:[],db:null,dbReady:null,deferredOperations:[]},e.db){if(!r)return t(e.db);Y(e),e.db.close()}var o=[e.name];r&&o.push(e.version);var n=Q.open.apply(Q,o);r&&(n.onupgradeneeded=function(s){var c=n.result;try{c.createObjectStore(e.storeName),s.oldVersion<=1&&c.createObjectStore(N)}catch(f){if("ConstraintError"!==f.name)throw f;console.warn('The database "'+e.name+'" has been upgraded from version '+s.oldVersion+" to version "+s.newVersion+', but the storage "'+e.storeName+'" already exists.')}}),n.onerror=function(s){s.preventDefault(),a(n.error)},n.onsuccess=function(){var s=n.result;s.onversionchange=function(c){c.target.close()},t(s),j(e)}})}function ie(e){return q(e,!1)}function pe(e){return q(e,!0)}function he(e,r){if(!e.db)return!0;var t=!e.db.objectStoreNames.contains(e.storeName),o=e.version>e.db.version;if(e.version<e.db.version&&(e.version!==r&&console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),o||t){if(t){var n=e.db.version+1;n>e.version&&(e.version=n)}return!0}return!1}function de(e){return re([T(atob(e.data))],{type:e.type})}function Se(e){return e&&e.__local_forage_encoded_blob}function Ae(e){var r=this,t=r._initReady().then(function(){var a=W[r._dbInfo.name];if(a&&a.dbReady)return a.dbReady});return U(t,e,e),t}function _(e,r,t,a){void 0===a&&(a=1);try{var o=e.db.transaction(e.storeName,r);t(null,o)}catch(n){if(a>0&&(!e.db||"InvalidStateError"===n.name||"NotFoundError"===n.name))return m.resolve().then(function(){if(!e.db||"NotFoundError"===n.name&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),pe(e)}).then(function(){return function v(e){Y(e);for(var r=W[e.name],t=r.forages,a=0;a<t.length;a++){var o=t[a];o._dbInfo.db&&(o._dbInfo.db.close(),o._dbInfo.db=null)}return e.db=null,ie(e).then(function(n){return e.db=n,he(e)?pe(e):n}).then(function(n){e.db=r.db=n;for(var s=0;s<t.length;s++)t[s]._dbInfo.db=n}).catch(function(n){throw K(e,n),n})}(e).then(function(){_(e,r,t,a-1)})}).catch(t);t(n)}}var fe={_driver:"asyncStorage",_initStorage:function h(e){var r=this,t={db:null};if(e)for(var a in e)t[a]=e[a];var o=W[t.name];o||(W[t.name]=o={forages:[],db:null,dbReady:null,deferredOperations:[]}),o.forages.push(r),r._initReady||(r._initReady=r.ready,r.ready=Ae);var n=[];function s(){return m.resolve()}for(var c=0;c<o.forages.length;c++){var f=o.forages[c];f!==r&&n.push(f._initReady().catch(s))}var l=o.forages.slice(0);return m.all(n).then(function(){return t.db=o.db,ie(t)}).then(function(d){return t.db=d,he(t,r._defaultConfig.version)?pe(t):d}).then(function(d){t.db=o.db=d,r._dbInfo=t;for(var g=0;g<l.length;g++){var S=l[g];S!==r&&(S._dbInfo.db=t.db,S._dbInfo.version=t.version)}})},_support:function E(){try{if(!Q||!Q.open)return!1;var e=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),r="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!e||r)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}(),iterate:function B(e,r){var t=this,a=new m(function(o,n){t.ready().then(function(){_(t._dbInfo,ue,function(s,c){if(s)return n(s);try{var l=c.objectStore(t._dbInfo.storeName).openCursor(),d=1;l.onsuccess=function(){var g=l.result;if(g){var S=g.value;Se(S)&&(S=de(S));var I=e(S,g.key,d++);void 0!==I?o(I):g.continue()}else o()},l.onerror=function(){n(l.error)}}catch(g){n(g)}})}).catch(n)});return y(a,r),a},getItem:function A(e,r){var t=this;e=P(e);var a=new m(function(o,n){t.ready().then(function(){_(t._dbInfo,ue,function(s,c){if(s)return n(s);try{var l=c.objectStore(t._dbInfo.storeName).get(e);l.onsuccess=function(){var d=l.result;void 0===d&&(d=null),Se(d)&&(d=de(d)),o(d)},l.onerror=function(){n(l.error)}}catch(d){n(d)}})}).catch(n)});return y(a,r),a},setItem:function D(e,r,t){var a=this;e=P(e);var o=new m(function(n,s){var c;a.ready().then(function(){return c=a._dbInfo,"[object Blob]"===xe.call(r)?R(c.db).then(function(f){return f?r:function be(e){return new m(function(r,t){var a=new FileReader;a.onerror=t,a.onloadend=function(o){var n=btoa(o.target.result||"");r({__local_forage_encoded_blob:!0,data:n,type:e.type})},a.readAsBinaryString(e)})}(r)}):r}).then(function(f){_(a._dbInfo,p,function(l,d){if(l)return s(l);try{var g=d.objectStore(a._dbInfo.storeName);null===f&&(f=void 0);var S=g.put(f,e);d.oncomplete=function(){void 0===f&&(f=null),n(f)},d.onabort=d.onerror=function(){s(S.error?S.error:S.transaction.error)}}catch(I){s(I)}})}).catch(s)});return y(o,t),o},removeItem:function k(e,r){var t=this;e=P(e);var a=new m(function(o,n){t.ready().then(function(){_(t._dbInfo,p,function(s,c){if(s)return n(s);try{var l=c.objectStore(t._dbInfo.storeName).delete(e);c.oncomplete=function(){o()},c.onerror=function(){n(l.error)},c.onabort=function(){n(l.error?l.error:l.transaction.error)}}catch(d){n(d)}})}).catch(n)});return y(a,r),a},clear:function ee(e){var r=this,t=new m(function(a,o){r.ready().then(function(){_(r._dbInfo,p,function(n,s){if(n)return o(n);try{var f=s.objectStore(r._dbInfo.storeName).clear();s.oncomplete=function(){a()},s.onabort=s.onerror=function(){o(f.error?f.error:f.transaction.error)}}catch(l){o(l)}})}).catch(o)});return y(t,e),t},length:function G(e){var r=this,t=new m(function(a,o){r.ready().then(function(){_(r._dbInfo,ue,function(n,s){if(n)return o(n);try{var f=s.objectStore(r._dbInfo.storeName).count();f.onsuccess=function(){a(f.result)},f.onerror=function(){o(f.error)}}catch(l){o(l)}})}).catch(o)});return y(t,e),t},key:function b(e,r){var t=this,a=new m(function(o,n){e<0?o(null):t.ready().then(function(){_(t._dbInfo,ue,function(s,c){if(s)return n(s);try{var f=c.objectStore(t._dbInfo.storeName),l=!1,d=f.openKeyCursor();d.onsuccess=function(){var g=d.result;g?0===e||l?o(g.key):(l=!0,g.advance(e)):o(null)},d.onerror=function(){n(d.error)}}catch(g){n(g)}})}).catch(n)});return y(a,r),a},keys:function $(e){var r=this,t=new m(function(a,o){r.ready().then(function(){_(r._dbInfo,ue,function(n,s){if(n)return o(n);try{var f=s.objectStore(r._dbInfo.storeName).openKeyCursor(),l=[];f.onsuccess=function(){var d=f.result;d?(l.push(d.key),d.continue()):a(l)},f.onerror=function(){o(f.error)}}catch(d){o(d)}})}).catch(o)});return y(t,e),t},dropInstance:function ce(e,r){r=H.apply(this,arguments);var t=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||t.name,e.storeName=e.storeName||t.storeName);var o,a=this;if(e.name){var s=e.name===t.name&&a._dbInfo.db?m.resolve(a._dbInfo.db):ie(e).then(function(c){var f=W[e.name],l=f.forages;f.db=c;for(var d=0;d<l.length;d++)l[d]._dbInfo.db=c;return c});o=s.then(e.storeName?function(c){if(c.objectStoreNames.contains(e.storeName)){var f=c.version+1;Y(e);var l=W[e.name],d=l.forages;c.close();for(var g=0;g<d.length;g++){var S=d[g];S._dbInfo.db=null,S._dbInfo.version=f}return new m(function(C,M){var Z=Q.open(e.name,f);Z.onerror=function(ne){Z.result.close(),M(ne)},Z.onupgradeneeded=function(){Z.result.deleteObjectStore(e.storeName)},Z.onsuccess=function(){var ne=Z.result;ne.close(),C(ne)}}).then(function(C){l.db=C;for(var M=0;M<d.length;M++){var Z=d[M];Z._dbInfo.db=C,j(Z._dbInfo)}}).catch(function(C){throw(K(e,C)||m.resolve()).catch(function(){}),C})}}:function(c){Y(e);var f=W[e.name],l=f.forages;c.close();for(var d=0;d<l.length;d++)l[d]._dbInfo.db=null;return new m(function(I,C){var M=Q.deleteDatabase(e.name);M.onerror=function(){var Z=M.result;Z&&Z.close(),C(M.error)},M.onblocked=function(){console.warn('dropInstance blocked for database "'+e.name+'" until all open connections are closed')},M.onsuccess=function(){var Z=M.result;Z&&Z.close(),I(Z)}}).then(function(I){f.db=I;for(var C=0;C<l.length;C++)j(l[C]._dbInfo)}).catch(function(I){throw(K(e,I)||m.resolve()).catch(function(){}),I})})}else o=m.reject("Invalid arguments");return y(o,r),o}};var J="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",w=/^~~local_forage_type~([^~]+)~/,F="__lfsc__:",le=F.length,me="arbf",Ie="blob",ze=le+me.length,Qe=Object.prototype.toString;function Je(e){var a,n,s,c,f,r=.75*e.length,t=e.length,o=0;"="===e[e.length-1]&&(r--,"="===e[e.length-2]&&r--);var l=new ArrayBuffer(r),d=new Uint8Array(l);for(a=0;a<t;a+=4)n=J.indexOf(e[a]),s=J.indexOf(e[a+1]),c=J.indexOf(e[a+2]),f=J.indexOf(e[a+3]),d[o++]=n<<2|s>>4,d[o++]=(15&s)<<4|c>>2,d[o++]=(3&c)<<6|63&f;return l}function Re(e){var a,r=new Uint8Array(e),t="";for(a=0;a<r.length;a+=3)t+=J[r[a]>>2],t+=J[(3&r[a])<<4|r[a+1]>>4],t+=J[(15&r[a+1])<<2|r[a+2]>>6],t+=J[63&r[a+2]];return r.length%3==2?t=t.substring(0,t.length-1)+"=":r.length%3==1&&(t=t.substring(0,t.length-2)+"=="),t}var Ce={serialize:function qe(e,r){var t="";if(e&&(t=Qe.call(e)),e&&("[object ArrayBuffer]"===t||e.buffer&&"[object ArrayBuffer]"===Qe.call(e.buffer))){var a,o=F;e instanceof ArrayBuffer?(a=e,o+=me):(a=e.buffer,"[object Int8Array]"===t?o+="si08":"[object Uint8Array]"===t?o+="ui08":"[object Uint8ClampedArray]"===t?o+="uic8":"[object Int16Array]"===t?o+="si16":"[object Uint16Array]"===t?o+="ur16":"[object Int32Array]"===t?o+="si32":"[object Uint32Array]"===t?o+="ui32":"[object Float32Array]"===t?o+="fl32":"[object Float64Array]"===t?o+="fl64":r(new Error("Failed to get type for BinaryArray"))),r(o+Re(a))}else if("[object Blob]"===t){var n=new FileReader;n.onload=function(){var s="~~local_forage_type~"+e.type+"~"+Re(this.result);r(F+Ie+s)},n.readAsArrayBuffer(e)}else try{r(JSON.stringify(e))}catch(s){console.error("Couldn't convert value into a JSON string: ",e),r(null,s)}},deserialize:function et(e){if(e.substring(0,le)!==F)return JSON.parse(e);var a,r=e.substring(ze),t=e.substring(le,ze);if(t===Ie&&w.test(r)){var o=r.match(w);a=o[1],r=r.substring(o[0].length)}var n=Je(r);switch(t){case me:return n;case Ie:return re([n],{type:a});case"si08":return new Int8Array(n);case"ui08":return new Uint8Array(n);case"uic8":return new Uint8ClampedArray(n);case"si16":return new Int16Array(n);case"ur16":return new Uint16Array(n);case"si32":return new Int32Array(n);case"ui32":return new Uint32Array(n);case"fl32":return new Float32Array(n);case"fl64":return new Float64Array(n);default:throw new Error("Unkown type: "+t)}},stringToBuffer:Je,bufferToString:Re};function He(e,r,t,a){e.executeSql("CREATE TABLE IF NOT EXISTS "+r.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],t,a)}function ve(e,r,t,a,o,n){e.executeSql(t,a,o,function(s,c){c.code===c.SYNTAX_ERR?s.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[r.storeName],function(f,l){l.rows.length?n(f,c):He(f,r,function(){f.executeSql(t,a,o,n)},n)},n):n(s,c)},n)}function Ge(e,r,t,a){var o=this;e=P(e);var n=new m(function(s,c){o.ready().then(function(){void 0===r&&(r=null);var f=r,l=o._dbInfo;l.serializer.serialize(r,function(d,g){g?c(g):l.db.transaction(function(S){ve(S,l,"INSERT OR REPLACE INTO "+l.storeName+" (key, value) VALUES (?, ?)",[e,d],function(){s(f)},function(I,C){c(C)})},function(S){if(S.code===S.QUOTA_ERR){if(a>0)return void s(Ge.apply(o,[e,f,t,a-1]));c(S)}})})}).catch(c)});return y(n,t),n}function ft(e){return new m(function(r,t){e.transaction(function(a){a.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(o,n){for(var s=[],c=0;c<n.rows.length;c++)s.push(n.rows.item(c).name);r({db:e,storeNames:s})},function(o,n){t(n)})},function(a){t(a)})})}var dt={_driver:"webSQLStorage",_initStorage:function tt(e){var r=this,t={db:null};if(e)for(var a in e)t[a]="string"!=typeof e[a]?e[a].toString():e[a];var o=new m(function(n,s){try{t.db=openDatabase(t.name,String(t.version),t.description,t.size)}catch(c){return s(c)}t.db.transaction(function(c){He(c,t,function(){r._dbInfo=t,n()},function(f,l){s(l)})},s)});return t.serializer=Ce,o},_support:function se(){return"function"==typeof openDatabase}(),iterate:function nt(e,r){var t=this,a=new m(function(o,n){t.ready().then(function(){var s=t._dbInfo;s.db.transaction(function(c){ve(c,s,"SELECT * FROM "+s.storeName,[],function(f,l){for(var d=l.rows,g=d.length,S=0;S<g;S++){var I=d.item(S),C=I.value;if(C&&(C=s.serializer.deserialize(C)),void 0!==(C=e(C,I.key,S+1)))return void o(C)}o()},function(f,l){n(l)})})}).catch(n)});return y(a,r),a},getItem:function rt(e,r){var t=this;e=P(e);var a=new m(function(o,n){t.ready().then(function(){var s=t._dbInfo;s.db.transaction(function(c){ve(c,s,"SELECT * FROM "+s.storeName+" WHERE key = ? LIMIT 1",[e],function(f,l){var d=l.rows.length?l.rows.item(0).value:null;d&&(d=s.serializer.deserialize(d)),o(d)},function(f,l){n(l)})})}).catch(n)});return y(a,r),a},setItem:function at(e,r,t){return Ge.apply(this,[e,r,t,1])},removeItem:function ot(e,r){var t=this;e=P(e);var a=new m(function(o,n){t.ready().then(function(){var s=t._dbInfo;s.db.transaction(function(c){ve(c,s,"DELETE FROM "+s.storeName+" WHERE key = ?",[e],function(){o()},function(f,l){n(l)})})}).catch(n)});return y(a,r),a},clear:function it(e){var r=this,t=new m(function(a,o){r.ready().then(function(){var n=r._dbInfo;n.db.transaction(function(s){ve(s,n,"DELETE FROM "+n.storeName,[],function(){a()},function(c,f){o(f)})})}).catch(o)});return y(t,e),t},length:function st(e){var r=this,t=new m(function(a,o){r.ready().then(function(){var n=r._dbInfo;n.db.transaction(function(s){ve(s,n,"SELECT COUNT(key) as c FROM "+n.storeName,[],function(c,f){var l=f.rows.item(0).c;a(l)},function(c,f){o(f)})})}).catch(o)});return y(t,e),t},key:function ut(e,r){var t=this,a=new m(function(o,n){t.ready().then(function(){var s=t._dbInfo;s.db.transaction(function(c){ve(c,s,"SELECT key FROM "+s.storeName+" WHERE id = ? LIMIT 1",[e+1],function(f,l){var d=l.rows.length?l.rows.item(0).key:null;o(d)},function(f,l){n(l)})})}).catch(n)});return y(a,r),a},keys:function ct(e){var r=this,t=new m(function(a,o){r.ready().then(function(){var n=r._dbInfo;n.db.transaction(function(s){ve(s,n,"SELECT key FROM "+n.storeName,[],function(c,f){for(var l=[],d=0;d<f.rows.length;d++)l.push(f.rows.item(d).key);a(l)},function(c,f){o(f)})})}).catch(o)});return y(t,e),t},dropInstance:function lt(e,r){r=H.apply(this,arguments);var t=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||t.name,e.storeName=e.storeName||t.storeName);var o,a=this;return y(o=e.name?new m(function(n){var s;s=e.name===t.name?a._dbInfo.db:openDatabase(e.name,"","",0),n(e.storeName?{db:s,storeNames:[e.storeName]}:ft(s))}).then(function(n){return new m(function(s,c){n.db.transaction(function(f){function l(I){return new m(function(C,M){f.executeSql("DROP TABLE IF EXISTS "+I,[],function(){C()},function(Z,ne){M(ne)})})}for(var d=[],g=0,S=n.storeNames.length;g<S;g++)d.push(l(n.storeNames[g]));m.all(d).then(function(){s()}).catch(function(I){c(I)})},function(f){c(f)})})}):m.reject("Invalid arguments"),r),o}};function je(e,r){var t=e.name+"/";return e.storeName!==r.storeName&&(t+=e.storeName+"/"),t}function mt(){return!function pt(){var e="_localforage_support_test";try{return localStorage.setItem(e,!0),localStorage.removeItem(e),!1}catch{return!0}}()||localStorage.length>0}var At={_driver:"localStorageWrapper",_initStorage:function ht(e){var t={};if(e)for(var a in e)t[a]=e[a];return t.keyPrefix=je(e,this._defaultConfig),mt()?(this._dbInfo=t,t.serializer=Ce,m.resolve()):m.reject()},_support:function vt(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}(),iterate:function bt(e,r){var t=this,a=t.ready().then(function(){for(var o=t._dbInfo,n=o.keyPrefix,s=n.length,c=localStorage.length,f=1,l=0;l<c;l++){var d=localStorage.key(l);if(0===d.indexOf(n)){var g=localStorage.getItem(d);if(g&&(g=o.serializer.deserialize(g)),void 0!==(g=e(g,d.substring(s),f++)))return g}}});return y(a,r),a},getItem:function yt(e,r){var t=this;e=P(e);var a=t.ready().then(function(){var o=t._dbInfo,n=localStorage.getItem(o.keyPrefix+e);return n&&(n=o.serializer.deserialize(n)),n});return y(a,r),a},setItem:function Tt(e,r,t){var a=this;e=P(e);var o=a.ready().then(function(){void 0===r&&(r=null);var n=r;return new m(function(s,c){var f=a._dbInfo;f.serializer.serialize(r,function(l,d){if(d)c(d);else try{localStorage.setItem(f.keyPrefix+e,l),s(n)}catch(g){("QuotaExceededError"===g.name||"NS_ERROR_DOM_QUOTA_REACHED"===g.name)&&c(g),c(g)}})})});return y(o,t),o},removeItem:function St(e,r){var t=this;e=P(e);var a=t.ready().then(function(){localStorage.removeItem(t._dbInfo.keyPrefix+e)});return y(a,r),a},clear:function gt(e){var r=this,t=r.ready().then(function(){for(var a=r._dbInfo.keyPrefix,o=localStorage.length-1;o>=0;o--){var n=localStorage.key(o);0===n.indexOf(a)&&localStorage.removeItem(n)}});return y(t,e),t},length:function xt(e){var t=this.keys().then(function(a){return a.length});return y(t,e),t},key:function wt(e,r){var t=this,a=t.ready().then(function(){var n,o=t._dbInfo;try{n=localStorage.key(e)}catch{n=null}return n&&(n=n.substring(o.keyPrefix.length)),n});return y(a,r),a},keys:function _t(e){var r=this,t=r.ready().then(function(){for(var a=r._dbInfo,o=localStorage.length,n=[],s=0;s<o;s++){var c=localStorage.key(s);0===c.indexOf(a.keyPrefix)&&n.push(c.substring(a.keyPrefix.length))}return n});return y(t,e),t},dropInstance:function Dt(e,r){if(r=H.apply(this,arguments),!(e="function"!=typeof e&&e||{}).name){var t=this.config();e.name=e.name||t.name,e.storeName=e.storeName||t.storeName}var o,a=this;return y(o=e.name?new m(function(n){n(e.storeName?je(e,a._defaultConfig):e.name+"/")}).then(function(n){for(var s=localStorage.length-1;s>=0;s--){var c=localStorage.key(s);0===c.indexOf(n)&&localStorage.removeItem(c)}}):m.reject("Invalid arguments"),r),o}},It=function(r,t){return r===t||"number"==typeof r&&"number"==typeof t&&isNaN(r)&&isNaN(t)},Rt=function(r,t){for(var a=r.length,o=0;o<a;){if(It(r[o],t))return!0;o++}return!1},Ve=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},we={},Xe={},ge={INDEXEDDB:fe,WEBSQL:dt,LOCALSTORAGE:At},Ct=[ge.INDEXEDDB._driver,ge.WEBSQL._driver,ge.LOCALSTORAGE._driver],Te=["dropInstance"],Ee=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(Te),Et={description:"",driver:Ct.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function Nt(e,r){e[r]=function(){var t=arguments;return e.ready().then(function(){return e[r].apply(e,t)})}}function Ne(){for(var e=1;e<arguments.length;e++){var r=arguments[e];if(r)for(var t in r)r.hasOwnProperty(t)&&(arguments[0][t]=Ve(r[t])?r[t].slice():r[t])}return arguments[0]}var Ot=function(){function e(r){for(var t in function z(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e),ge)if(ge.hasOwnProperty(t)){var a=ge[t],o=a._driver;this[t]=o,we[o]||this.defineDriver(a)}this._defaultConfig=Ne({},Et),this._config=Ne({},this._defaultConfig,r),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return e.prototype.config=function(t){if("object"===(typeof t>"u"?"undefined":L(t))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var a in t){if("storeName"===a&&(t[a]=t[a].replace(/\W/g,"_")),"version"===a&&"number"!=typeof t[a])return new Error("Database version must be a number.");this._config[a]=t[a]}return!("driver"in t)||!t.driver||this.setDriver(this._config.driver)}return"string"==typeof t?this._config[t]:this._config},e.prototype.defineDriver=function(t,a,o){var n=new m(function(s,c){try{var f=t._driver,l=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!t._driver)return void c(l);for(var d=Ee.concat("_initStorage"),g=0,S=d.length;g<S;g++){var I=d[g];if((!Rt(Te,I)||t[I])&&"function"!=typeof t[I])return void c(l)}!function(){for(var _e=function(kt){return function(){var Bt=new Error("Method "+kt+" is not implemented by the current driver"),Ke=m.reject(Bt);return y(Ke,arguments[arguments.length-1]),Ke}},Oe=0,Pt=Te.length;Oe<Pt;Oe++){var Le=Te[Oe];t[Le]||(t[Le]=_e(Le))}}();var Z=function(_e){we[f]&&console.info("Redefining LocalForage driver: "+f),we[f]=t,Xe[f]=_e,s()};"_support"in t?t._support&&"function"==typeof t._support?t._support().then(Z,c):Z(!!t._support):Z(!0)}catch(ne){c(ne)}});return U(n,a,o),n},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(t,a,o){var n=we[t]?m.resolve(we[t]):m.reject(new Error("Driver not found."));return U(n,a,o),n},e.prototype.getSerializer=function(t){var a=m.resolve(Ce);return U(a,t),a},e.prototype.ready=function(t){var a=this,o=a._driverSet.then(function(){return null===a._ready&&(a._ready=a._initDriver()),a._ready});return U(o,t,t),o},e.prototype.setDriver=function(t,a,o){var n=this;Ve(t)||(t=[t]);var s=this._getSupportedDrivers(t);function c(){n._config.driver=n.driver()}function f(g){return n._extend(g),c(),n._ready=n._initStorage(n._config),n._ready}var d=null!==this._driverSet?this._driverSet.catch(function(){return m.resolve()}):m.resolve();return this._driverSet=d.then(function(){var g=s[0];return n._dbInfo=null,n._ready=null,n.getDriver(g).then(function(S){n._driver=S._driver,c(),n._wrapLibraryMethodsWithReady(),n._initDriver=function l(g){return function(){var S=0;return function I(){for(;S<g.length;){var C=g[S];return S++,n._dbInfo=null,n._ready=null,n.getDriver(C).then(f).catch(I)}c();var M=new Error("No available storage method found.");return n._driverSet=m.reject(M),n._driverSet}()}}(s)})}).catch(function(){c();var g=new Error("No available storage method found.");return n._driverSet=m.reject(g),n._driverSet}),U(this._driverSet,a,o),this._driverSet},e.prototype.supports=function(t){return!!Xe[t]},e.prototype._extend=function(t){Ne(this,t)},e.prototype._getSupportedDrivers=function(t){for(var a=[],o=0,n=t.length;o<n;o++){var s=t[o];this.supports(s)&&a.push(s)}return a},e.prototype._wrapLibraryMethodsWithReady=function(){for(var t=0,a=Ee.length;t<a;t++)Nt(this,Ee[t])},e.prototype.createInstance=function(t){return new e(t)},e}(),Lt=new Ot;te.exports=Lt},{3:3}]},{},[4])(4)}}]);