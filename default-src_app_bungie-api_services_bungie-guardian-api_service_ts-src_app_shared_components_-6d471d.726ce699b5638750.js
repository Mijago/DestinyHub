"use strict";(self.webpackChunkD2Hub=self.webpackChunkD2Hub||[]).push([["default-src_app_bungie-api_services_bungie-guardian-api_service_ts-src_app_shared_components_-6d471d"],{6625:(F,A,i)=>{i.d(A,{J:()=>U});var g=i(5861),t=i(8012),e=i(4650),I=i(4623);let U=(()=>{class d{constructor(m){this.api=m}getCollectibleStatus(m,h){var _=this;return(0,g.Z)(function*(){return(yield(0,t.Ai)(T=>_.api.$http(T),{membershipType:m,destinyMembershipId:h,components:[800]})).Response.profileCollectibles.data?.collectibles||{}})()}getCharacters(m,h){var _=this;return(0,g.Z)(function*(){return(yield(0,t.Ai)(T=>_.api.$http(T),{membershipType:m,destinyMembershipId:h,components:[200]})).Response})()}getCharacterActivityCount(m,h,_){return(0,g.Z)(function*(){})()}}return d.\u0275fac=function(m){return new(m||d)(e.LFG(I.A))},d.\u0275prov=e.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"}),d})()},1731:(F,A,i)=>{i.d(A,{Q:()=>c});var g=i(5861),t=i(4650),e=i(4006),I=i(9300),U=i(8372),d=i(3900),b=i(9646),m=i(262),h=i(3905),_=i(4004),f=i(2340),T=i(529),L=i(945);let D=(()=>{class a{constructor(n,o){this.http=n,this.logger=o}search(n){var o=this;return(0,g.Z)(function*(){return(yield o.searchWithTrialsReport(n))??(yield o.searchWithBungieApi(n))})()}searchWithTrialsReport(n){var o=this;return(0,g.Z)(function*(){const s="https://elastic.destinytrialsreport.com/players/0/"+encodeURIComponent(encodeURIComponent(n));let C=o.http.get(s).pipe((0,m.K)(x=>(o.logger.error(`Trials Report: could not fetch guardians for name "${n}" `,x),(0,b.of)(null))));return yield(0,h.z)(C)})()}searchWithBungieApi(n){var o=this;return(0,g.Z)(function*(){const s=`https://www.bungie.net/Platform/Destiny2/SearchDestinyPlayer/-1/${encodeURIComponent(n)}/`;let C=o.http.get(s,{headers:{"X-API-Key":f.N.bungie.apiKey}}).pipe((0,m.K)(p=>(o.logger.error(`Trials Report: could not fetch guardians for name "${n}" `,p),(0,b.of)(null))),(0,_.U)(p=>null==p?p:p.Response));const x=yield(0,h.z)(C);if(null==x)return x;x.map(p=>({emblemHash:"",membershipId:p.membershipId,membershipType:p.membershipType,bungieName:p.bungieGlobalDisplayName+"#"+p.bungieGlobalDisplayNameCode,displayName:p.displayName,crossSaveOverride:{membershipId:"",membershipType:p.crossSaveOverride}}))})()}}return a.\u0275fac=function(n){return new(n||a)(t.LFG(T.eN),t.LFG(L.Kf))},a.\u0275prov=t.Yz7({token:a,factory:a.\u0275fac,providedIn:"root"}),a})();var M=i(394),Z=i(6895),S=i(7392),P=i(4859),O=i(9549),E=i(7957),G=i(3238),N=i(266),y=i(7331);function Q(a,r){if(1&a&&t._UZ(0,"img",4),2&a){const n=t.oxw();t.ekj("centered",n.centered)("fullWidth",!n.centered)}}function B(a,r){if(1&a&&t._UZ(0,"img",5),2&a){const n=t.oxw();t.ekj("centered",n.centered)("fullWidth",!n.centered)}}function W(a,r){if(1&a&&t._UZ(0,"img",6),2&a){const n=t.oxw();t.ekj("centered",n.centered)("fullWidth",!n.centered)}}function J(a,r){if(1&a&&t._UZ(0,"img",7),2&a){const n=t.oxw();t.ekj("centered",n.centered)("fullWidth",!n.centered)}}let R=(()=>{class a{constructor(){this.centered=!1,this.membershipType=0}ngOnInit(){}}return a.\u0275fac=function(n){return new(n||a)},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-platform-icon"]],inputs:{centered:"centered",membershipType:"membershipType"},decls:4,vars:4,consts:[["class","user-chip-icon","src","https://bungie.net//img/theme/bungienet/icons/steamLogo.png","aria-hidden","",3,"centered","fullWidth",4,"ngIf"],["class","user-chip-icon","src","https://bungie.net//img/theme/bungienet/icons/xboxLiveLogo.png","aria-hidden","",3,"centered","fullWidth",4,"ngIf"],["class","user-chip-icon","src","https://bungie.net//img/theme/bungienet/icons/psnLogo.png","aria-hidden","",3,"centered","fullWidth",4,"ngIf"],["class","user-chip-icon","src","https://bungie.net//img/theme/destiny/icons/icon_stadia.png","aria-hidden","",3,"centered","fullWidth",4,"ngIf"],["src","https://bungie.net//img/theme/bungienet/icons/steamLogo.png","aria-hidden","",1,"user-chip-icon"],["src","https://bungie.net//img/theme/bungienet/icons/xboxLiveLogo.png","aria-hidden","",1,"user-chip-icon"],["src","https://bungie.net//img/theme/bungienet/icons/psnLogo.png","aria-hidden","",1,"user-chip-icon"],["src","https://bungie.net//img/theme/destiny/icons/icon_stadia.png","aria-hidden","",1,"user-chip-icon"]],template:function(n,o){1&n&&(t.YNc(0,Q,1,4,"img",0),t.YNc(1,B,1,4,"img",1),t.YNc(2,W,1,4,"img",2),t.YNc(3,J,1,4,"img",3)),2&n&&(t.Q6J("ngIf",3==o.membershipType),t.xp6(1),t.Q6J("ngIf",1==o.membershipType),t.xp6(1),t.Q6J("ngIf",2==o.membershipType),t.xp6(1),t.Q6J("ngIf",5==o.membershipType))},dependencies:[Z.O5],styles:[".user-chip-icon.fullWidth[_ngcontent-%COMP%]{height:100%}.user-chip-icon.centered[_ngcontent-%COMP%]{height:25px;vertical-align:middle;margin-right:8px}"]}),a})();const K=["guardianInput"];function u(a,r){if(1&a){const n=t.EpF();t.TgZ(0,"mat-chip",10,11),t.NdJ("removed",function(){t.CHM(n);const s=t.oxw();return t.KtG(s.selectGuardian(null))})("selectionChange",function(){t.CHM(n);const s=t.MAs(1);return t.KtG(s.select())}),t._UZ(2,"app-platform-icon",12),t._uU(3),t.TgZ(4,"button",13)(5,"mat-icon"),t._uU(6,"cancel"),t.qZA()()()}if(2&a){const n=t.oxw();t.xp6(2),t.Q6J("membershipType",n.selectedGuardian.membershipType)("centered",!1),t.xp6(1),t.hij(" ",n.selectedGuardian.bungieName," ")}}function v(a,r){if(1&a&&(t.TgZ(0,"mat-option",14),t._UZ(1,"app-platform-icon",15),t._uU(2),t.qZA()),2&a){const n=r.$implicit;t.Q6J("value",n),t.xp6(1),t.Q6J("membershipType",n.membershipType)("centered",!0),t.xp6(1),t.hij(" ",n.bungieName," ")}}function l(a,r){if(1&a){const n=t.EpF();t.TgZ(0,"button",16),t.NdJ("click",function(){t.CHM(n);const s=t.oxw();return t.KtG(s.selectAuthGuardian())}),t.TgZ(1,"mat-icon"),t._uU(2,"person"),t.qZA()()}if(2&a){const n=t.oxw();t.Q6J("disabled",!!n.selectedGuardian)}}let c=(()=>{class a{constructor(n,o){this.guardianSearch=n,this.auth=o,this.enableLoggedInUser=!1,this.onGuardianSelection=new t.vpe,this.guardianSearchFormControl=new e.NI,this.selectedGuardian=null,this.guardians=this.guardianSearchFormControl.valueChanges.pipe((0,I.h)(s=>"string"==typeof s),(0,U.b)(500),(0,d.w)(s=>""==s?(0,b.of)([]):this.searchUsers(s)))}ngOnInit(){}searchUsers(n){var o=this;return(0,g.Z)(function*(){return o.guardianSearch.search(n)})()}selectAuthGuardian(){var n=this.auth.currentUser.primaryMembershipId,o=this.auth.currentUser.destinyMemberships.filter(s=>s.membershipId==n)[0].membershipType;this.selectGuardian({bnetId:0,crossSaveOverride:void 0,displayName:"",emblemHash:"",lastPlayed:"",membershipId:n,membershipType:o,score:0,bungieName:this.auth.currentUser?.bungieNetUser.cachedBungieGlobalDisplayName+"#"+this.auth.currentUser?.bungieNetUser.cachedBungieGlobalDisplayNameCode})}selectGuardian(n){this.guardianInput.nativeElement.value="",this.guardianSearchFormControl.setValue(null),null==n?this.guardianSearchFormControl.enable():this.guardianSearchFormControl.disable(),this.selectedGuardian=n,this.onGuardianSelection.next(n)}}return a.\u0275fac=function(n){return new(n||a)(t.Y36(D),t.Y36(M.F))},a.\u0275cmp=t.Xpm({type:a,selectors:[["app-guardian-selection"]],viewQuery:function(n,o){if(1&n&&t.Gf(K,5),2&n){let s;t.iGM(s=t.CRH())&&(o.guardianInput=s.first)}},inputs:{enableLoggedInUser:"enableLoggedInUser"},outputs:{onGuardianSelection:"onGuardianSelection"},decls:13,vars:9,consts:[["appearance","fill",1,"example-chip-list"],["aria-label","Select a Guardian"],["chipList",""],["color","primary","selected","",3,"removed","selectionChange",4,"ngIf"],[3,"placeholder","formControl","matAutocomplete","matChipInputFor"],["guardianInput",""],[3,"optionSelected"],["auto","matAutocomplete"],[3,"value",4,"ngFor","ngForOf"],["matSuffix","","mat-icon-button","","aria-label","Select yourself","matTooltip","Select yourself.",3,"disabled","click",4,"ngIf"],["color","primary","selected","",3,"removed","selectionChange"],["chip","matChip"],["matChipAvatar","",3,"membershipType","centered"],["matChipRemove",""],[3,"value"],[3,"membershipType","centered"],["matSuffix","","mat-icon-button","","aria-label","Select yourself","matTooltip","Select yourself.",3,"disabled","click"]],template:function(n,o){if(1&n&&(t.TgZ(0,"mat-form-field",0)(1,"mat-label"),t._uU(2,"Select a Guardian"),t.qZA(),t.TgZ(3,"mat-chip-list",1,2),t.YNc(5,u,7,3,"mat-chip",3),t._UZ(6,"input",4,5),t.TgZ(8,"mat-autocomplete",6,7),t.NdJ("optionSelected",function(C){return o.selectGuardian(C.option.value)}),t.YNc(10,v,3,4,"mat-option",8),t.ALo(11,"async"),t.qZA()(),t.YNc(12,l,3,1,"button",9),t.qZA()),2&n){const s=t.MAs(4),C=t.MAs(9);t.xp6(5),t.Q6J("ngIf",o.selectedGuardian),t.xp6(1),t.Q6J("placeholder",o.selectedGuardian?"":"Guardian#1234")("formControl",o.guardianSearchFormControl)("matAutocomplete",C)("matChipInputFor",s),t.xp6(4),t.Q6J("ngForOf",t.lcZ(11,7,o.guardians)),t.xp6(2),t.Q6J("ngIf",o.enableLoggedInUser&&o.auth.isLoggedIn)}},dependencies:[Z.sg,Z.O5,e.Fj,e.JJ,e.oH,S.Hw,P.lW,O.KE,O.hX,O.R9,E.XC,E.ZL,G.ey,N.gM,y.qn,y.HS,y.oH,y.qH,y.EC,R,Z.Ov],styles:[".example-chip-list[_ngcontent-%COMP%]{width:100%}"]}),a})()},1184:(F,A,i)=>{i.d(A,{$:()=>K});var g=i(727),t=i(5963),e=i(4650),I=i(2289),U=i(394),d=i(4649),b=i(6074),m=i(559),h=i(6895),_=i(1048),f=i(3267),T=i(7392),L=i(3683),D=i(4859),M=i(4633),Z=i(3238),S=i(3162),P=i(8255),O=i(266),E=i(2673);function G(u,v){if(1&u){const l=e.EpF();e.TgZ(0,"button",30),e.NdJ("click",function(){e.CHM(l),e.oxw();const a=e.MAs(41);return e.KtG(a.toggle())}),e.TgZ(1,"mat-icon"),e._uU(2,"menu"),e.qZA()()}}function N(u,v){if(1&u){const l=e.EpF();e.ynx(0),e.TgZ(1,"button",30),e.NdJ("click",function(){e.CHM(l);const a=e.oxw();return e.KtG(a.authService.startLogin())}),e.TgZ(2,"mat-icon"),e._uU(3,"login"),e.qZA()(),e.BQk()}}function y(u,v){if(1&u){const l=e.EpF();e.ynx(0),e.TgZ(1,"button",31)(2,"mat-icon",32),e._uU(3,"notifications"),e.qZA()(),e.TgZ(4,"mat-menu",12,33)(6,"a",34)(7,"span"),e._uU(8,"You have new tasks"),e.qZA()(),e.TgZ(9,"a",34)(10,"span"),e._uU(11,"You have a new message"),e.qZA()()(),e.TgZ(12,"button",35)(13,"mat-icon"),e._uU(14,"person"),e.qZA(),e.TgZ(15,"span",36),e._uU(16),e.ALo(17,"async"),e.ALo(18,"async"),e.qZA()(),e.TgZ(19,"mat-menu",12,37)(21,"a",14),e.NdJ("click",function(){e.CHM(l);const a=e.oxw();return e.KtG(a.authService.logOut())}),e.TgZ(22,"mat-icon"),e._uU(23,"exit_to_app"),e.qZA(),e.TgZ(24,"span"),e._uU(25,"Log out"),e.qZA()()(),e.BQk()}if(2&u){const l=e.MAs(5),c=e.MAs(20),a=e.oxw();let r;e.xp6(1),e.Q6J("matMenuTriggerFor",l),e.xp6(3),e.Q6J("overlapTrigger",!1),e.xp6(8),e.Q6J("matMenuTriggerFor",c),e.xp6(4),e.AsE(" ",null==(r=e.lcZ(17,6,a.authService.userData))||null==r.bungieNetUser?null:r.bungieNetUser.cachedBungieGlobalDisplayName,"#",null==(r=e.lcZ(18,8,a.authService.userData))||null==r.bungieNetUser?null:r.bungieNetUser.cachedBungieGlobalDisplayNameCode," "),e.xp6(3),e.Q6J("overlapTrigger",!1)}}function Q(u,v){1&u&&e._UZ(0,"mat-progress-bar",38)}const B=function(){return["/"]},W=function(){return["/rewards"]},J=function(){return["/trials"]},R=function(){return["/about"]};let K=(()=>{class u{constructor(l,c,a,r,n,o){this.changeDetectorRef=l,this.media=c,this.authService=a,this.spinnerService=r,this.themeService=n,this.authGuard=o,this.autoLogoutSubscription=new g.w0,this.userName="",this.mobileQuery=this.media.matchMedia("(max-width: 1000px)"),this._mobileQueryListener=()=>l.detectChanges(),this.mobileQuery.addListener(this._mobileQueryListener)}ngOnInit(){const l=(0,t.H)(2e3,5e3);this.autoLogoutSubscription=l.subscribe(()=>{this.authGuard.canActivate()});const c=this.authService.currentUser;c&&(this.userName=c.bungieNetUser.cachedBungieGlobalDisplayName+"#"+c.bungieNetUser.cachedBungieGlobalDisplayNameCode)}ngOnDestroy(){this.mobileQuery.removeListener(this._mobileQueryListener),this.autoLogoutSubscription.unsubscribe()}ngAfterViewInit(){this.changeDetectorRef.detectChanges()}}return u.\u0275fac=function(l){return new(l||u)(e.Y36(e.sBO),e.Y36(I.vx),e.Y36(U.F),e.Y36(d.V),e.Y36(b.f),e.Y36(m.g))},u.\u0275cmp=e.Xpm({type:u,selectors:[["app-layout"]],decls:67,vars:25,consts:[[1,"navbar-container"],["color","primary",1,"navbar"],["mat-icon-button","",3,"click",4,"ngIf"],["matTooltip","Home",1,"navbar-brand",3,"routerLink"],["href","https://twitter.com/MijagoCoding/","matTooltip","Birb App","target","_blank"],["alt","Me on twitter","src","assets/logos/logo-twitter.png",1,"logo-twitter"],["href","https://ko-fi.com/mijago","matTooltip","If you like my work, you can always buy me a coffee!","target","_blank"],["alt","Ko-Fi","src","assets/logos/logo-kofi.png",1,"logo-twitter"],["href","http://discord.d2armorpicker.com/","matTooltip","Visit me at the development & support discord.","target","_blank"],["alt","Discord","src","assets/logos/logo-discord.png",1,"logo-twitter"],[1,"navbar-spacer"],["mat-icon-button","","aria-label","Change Theme Menu",3,"matMenuTriggerFor"],["xPosition","before","yPosition","above",3,"overlapTrigger"],["themeMenu","matMenu"],["mat-menu-item","",3,"click"],["svgIcon","titan",1,"titan-color"],["svgIcon","warlock",1,"warlock-color"],["svgIcon","hunter",1,"hunter-color"],[4,"ngIf"],[1,"navbar-sidenav-container"],["fixedTopGap","56",1,"sidenav",3,"opened","mode","fixedInViewport"],["snav",""],["mat-subheader",""],["mat-list-item","","routerLinkActive","active",3,"routerLink"],["mat-list-icon",""],["mat-line",""],["id","push-bottom","mat-list-item","","routerLinkActive","active",3,"routerLink"],[1,"sidenav-content"],[1,"progress-bar-container"],["color","accent","mode","indeterminate",4,"ngIf"],["mat-icon-button","",3,"click"],["mat-icon-button","",3,"matMenuTriggerFor"],["matBadge","2","matBadgeColor","accent"],["notificationMenu","matMenu"],["mat-menu-item",""],["mat-button","",3,"matMenuTriggerFor"],["fxShow","","fxHide.xs",""],["userMenu","matMenu"],["color","accent","mode","indeterminate"]],template:function(l,c){if(1&l&&(e.TgZ(0,"div",0)(1,"mat-toolbar",1),e.YNc(2,G,3,0,"button",2),e.TgZ(3,"a",3)(4,"h1"),e._uU(5," Destiny Hub "),e.TgZ(6,"small"),e._uU(7,"by Mijago"),e.qZA(),e.TgZ(8,"a",4),e._UZ(9,"img",5),e.qZA(),e.TgZ(10,"a",6),e._UZ(11,"img",7),e.qZA(),e.TgZ(12,"a",8),e._UZ(13,"img",9),e.qZA()()(),e._UZ(14,"span",10),e.TgZ(15,"button",11)(16,"mat-icon"),e._uU(17,"format_color_fill"),e.qZA()(),e.TgZ(18,"mat-menu",12,13)(20,"a",14),e.NdJ("click",function(){return c.themeService.activateTheme("theme-titan")}),e.TgZ(21,"mat-icon",15),e._uU(22,"titan"),e.qZA(),e.TgZ(23,"span"),e._uU(24,"Titan"),e.qZA()(),e.TgZ(25,"a",14),e.NdJ("click",function(){return c.themeService.activateTheme("theme-warlock")}),e.TgZ(26,"mat-icon",16),e._uU(27,"warlock"),e.qZA(),e.TgZ(28,"span"),e._uU(29,"Warlock"),e.qZA()(),e.TgZ(30,"a",14),e.NdJ("click",function(){return c.themeService.activateTheme("theme-hunter")}),e.TgZ(31,"mat-icon",17),e._uU(32,"hunter"),e.qZA(),e.TgZ(33,"span"),e._uU(34,"Hunter"),e.qZA()()(),e.YNc(35,N,4,0,"ng-container",18),e.ALo(36,"async"),e.YNc(37,y,26,10,"ng-container",18),e.ALo(38,"async"),e.qZA(),e.TgZ(39,"mat-sidenav-container",19)(40,"mat-sidenav",20,21)(42,"mat-nav-list")(43,"h3",22),e._uU(44,"Home"),e.qZA(),e.TgZ(45,"a",23)(46,"mat-icon",24),e._uU(47," qr_code "),e.qZA(),e.TgZ(48,"p",25),e._uU(49,"Bungie Reward Codes"),e.qZA()(),e.TgZ(50,"h3",22),e._uU(51,"Statistics"),e.qZA(),e.TgZ(52,"a",23)(53,"mat-icon",24),e._uU(54," analytics "),e.qZA(),e.TgZ(55,"p",25),e._uU(56," Trials Statistics "),e.qZA()(),e.TgZ(57,"a",26)(58,"mat-icon",24),e._uU(59," info_outline "),e.qZA(),e.TgZ(60,"p",25),e._uU(61," About "),e.qZA()()()(),e.TgZ(62,"mat-sidenav-content",27)(63,"div",28),e.YNc(64,Q,1,0,"mat-progress-bar",29),e.ALo(65,"async"),e.qZA(),e._UZ(66,"router-outlet"),e.qZA()()()),2&l){const a=e.MAs(19);e.ekj("example-is-mobile",c.mobileQuery.matches),e.xp6(2),e.Q6J("ngIf",c.mobileQuery.matches),e.xp6(1),e.Q6J("routerLink",e.DdM(21,B)),e.xp6(12),e.Q6J("matMenuTriggerFor",a),e.xp6(3),e.Q6J("overlapTrigger",!1),e.xp6(17),e.Q6J("ngIf",!e.lcZ(36,15,c.authService.loggedIn)),e.xp6(2),e.Q6J("ngIf",e.lcZ(38,17,c.authService.loggedIn)),e.xp6(3),e.Q6J("opened",!c.mobileQuery.matches)("mode",c.mobileQuery.matches?"over":"side")("fixedInViewport",c.mobileQuery.matches),e.xp6(5),e.Q6J("routerLink",e.DdM(22,W)),e.xp6(7),e.Q6J("routerLink",e.DdM(23,J)),e.xp6(5),e.Q6J("routerLink",e.DdM(24,R)),e.xp6(7),e.Q6J("ngIf",e.lcZ(65,19,c.spinnerService.visibility))}},dependencies:[h.O5,_.lC,_.yS,_.Od,f.JX,f.TM,f.Rh,T.Hw,L.Ye,D.lW,M.Hk,M.Tg,Z.X2,M.Nh,M.gs,S.pW,P.VK,P.OP,P.p6,O.gM,E.k,h.Ov],styles:[".titan-color[_ngcontent-%COMP%]{color:#c62828!important}.warlock-color[_ngcontent-%COMP%]{color:#ffc107!important}.hunter-color[_ngcontent-%COMP%]{color:#64b5f6!important}.navbar-spacer[_ngcontent-%COMP%]{flex:1 1 auto}.navbar[_ngcontent-%COMP%]{z-index:2}.navbar-brand[_ngcontent-%COMP%]{text-decoration:none;color:inherit}.navbar-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;position:absolute;inset:0}.navbar-is-mobile[_ngcontent-%COMP%]   .navbar[_ngcontent-%COMP%]{position:fixed;z-index:2}.navbar-sidenav-container[_ngcontent-%COMP%]{flex:1}.navbar-is-mobile[_ngcontent-%COMP%]   .navbar-sidenav-container[_ngcontent-%COMP%]{flex:1 0 auto}mat-sidenav[_ngcontent-%COMP%]{min-width:180px!important;border-right:1px solid rgba(238,238,238,0);box-shadow:6px 0 6px #0000001a}.progress-bar-container[_ngcontent-%COMP%]{height:5px}a.mat-list-item.active[_ngcontent-%COMP%]{background:rgba(0,0,0,.04)}#push-bottom[_ngcontent-%COMP%]{position:absolute;bottom:0}.logo-twitter[_ngcontent-%COMP%]{width:17px}"]}),u})()}}]);