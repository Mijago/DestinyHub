(self.webpackChunkD2Hub=self.webpackChunkD2Hub||[]).push([["src_app_features_trials-data-report_trials-data-report_module_ts"],{3540:(Ze,_e,O)=>{"use strict";O.r(_e),O.d(_e,{TrialsDataReportModule:()=>Oe});var Ee=O(6895),ie=O(3797),re=O(1184),K=O(5861),k=O(3905),z=O(7009),o=O(4650);let Q=(()=>{class d{constructor(u){this.data=u}ngOnInit(){}}return d.\u0275fac=function(u){return new(u||d)(o.Y36(z.qD))},d.\u0275cmp=o.Xpm({type:d,selectors:[["app-progress-toast"]],decls:1,vars:1,template:function(u,p){1&u&&o._uU(0),2&u&&o.hij("",p.data,"\n")}}),d})();var N=O(7340),ne=O(4424),h=O(529);let b=(()=>{class d{constructor(u){this.http=u}getApiData(u){return this.http.get("https://api.trialsofthenine.com/weeks/"+u)}getMostRecent(){return this.getApiData(0)}}return d.\u0275fac=function(u){return new(u||d)(o.LFG(h.eN))},d.\u0275prov=o.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"}),d})();var F=O(7392),P=O(3546),V=O(1576),L=O(2054);let se=(()=>{class d{constructor(){this.subclassData=[],this.chartOption={tooltip:{trigger:"item",confine:!0,formatter:u=>{let p=u.data;var A=(100*p.percent).toFixed(1);return isNaN(p.percent)?`Total: ${p.value.toLocaleString()}`:`${p.name}: ${p.value.toLocaleString()} (${A}%)`}},title:{},series:[{data:[],type:"sunburst",center:["48%","55%"],radius:[0,"90%"],label:{rotate:"radial"}}]}}isHunter(u){return["Gunslinger","Revenant","Arcstrider","Nightstalker","Threadrunner"].indexOf(u.name)>-1}isWarlock(u){return["Dawnblade","Shadebinder","Stormcaller","Voidwalker","Broodweaver"].indexOf(u.name)>-1}isTitan(u){return["Sunbreaker","Behemoth","Striker","Sentinel","Berserker"].indexOf(u.name)>-1}ngOnChanges(u){var p=this.subclassData.filter(y=>this.isHunter(y)),A=this.subclassData.filter(y=>this.isWarlock(y)),U=this.subclassData.filter(y=>this.isTitan(y)),D=p.reduce((y,H)=>y+H.amount,0),B=A.reduce((y,H)=>y+H.amount,0),J=U.reduce((y,H)=>y+H.amount,0),M=D+J+B;this.chartOption.series[0].data=[{name:"Hunter",children:p.map(y=>({name:y.name,value:y.amount,itemStyle:{color:"#77afc0"},percent:y.amount/D})),itemStyle:{color:"#5f9cbb"},percent:D/M},{name:"Warlock",children:A.map(y=>({name:y.name,value:y.amount,itemStyle:{color:"#bdb177"},percent:y.amount/B})),itemStyle:{color:"#d7c16e"},percent:B/M},{name:"Titan",children:U.map(y=>({name:y.name,value:y.amount,itemStyle:{color:"#bd7777"},percent:y.amount/J})),itemStyle:{color:"#b76262"},percent:J/M}]}ngOnInit(){}}return d.\u0275fac=function(u){return new(u||d)},d.\u0275cmp=o.Xpm({type:d,selectors:[["app-class-and-subclass-chart"]],inputs:{subclassData:"subclassData"},features:[o.TTD],decls:1,vars:1,consts:[["echarts","",1,"demo-chart",3,"options"]],template:function(u,p){1&u&&o._UZ(0,"div",0),2&u&&o.Q6J("options",p.chartOption)},dependencies:[L._w]}),d})(),W=(()=>{class d{constructor(){this.weeks=[],this.overwrite={series:[{},{},{}]},this.chartOption={tooltip:{trigger:"axis",confine:!0},legend:{type:"scroll",textStyle:{color:"white"},show:!0},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},xAxis:[{type:"time",boundaryGap:!1}],yAxis:[{alignTicks:!0,type:"value",max:100,min:0}],series:[{name:"Hunter",type:"line",stack:"Total",color:"#5f9cbb",areaStyle:{},emphasis:{focus:"series"},data:[]},{name:"Titan",type:"line",stack:"Total",color:"#b76262",areaStyle:{},emphasis:{focus:"series"},data:[]},{name:"Warlock",type:"line",stack:"Total",color:"#b6b45c",areaStyle:{},emphasis:{focus:"series"},data:[]}]}}isHunter(u){return["Gunslinger","Revenant","Arcstrider","Nightstalker","Threadrunner"].indexOf(u.name)>-1}isWarlock(u){return["Dawnblade","Shadebinder","Stormcaller","Voidwalker","Broodweaver"].indexOf(u.name)>-1}isTitan(u){return["Sunbreaker","Behemoth","Striker","Sentinel","Berserker"].indexOf(u.name)>-1}ngOnInit(){}ngOnChanges(u){if(0!=this.weeks.length){var p=[],A=[],U=[];for(let fe of this.weeks){var D=new Date(Date.parse(fe.startDate)),B=[D.getFullYear(),D.getMonth()+1,D.getDate()].join("/"),J=fe.subclass.filter(G=>this.isHunter(G)),M=fe.subclass.filter(G=>this.isWarlock(G)),y=fe.subclass.filter(G=>this.isTitan(G)),H=J.reduce((G,te)=>G+te.amount,0),ve=M.reduce((G,te)=>G+te.amount,0),me=y.reduce((G,te)=>G+te.amount,0),j=H+ve+me;0!=j&&(p.push([B,(H/j*100).toFixed(2)]),A.push([B,(me/j*100).toFixed(2)]),U.push([B,(ve/j*100).toFixed(2)]))}this.overwrite.series[0].data=p,this.overwrite.series[1].data=A,this.overwrite.series[2].data=U,this.overwrite=Object.assign({},this.overwrite)}}}return d.\u0275fac=function(u){return new(u||d)},d.\u0275cmp=o.Xpm({type:d,selectors:[["app-class-and-subclass-timeline-chart"]],inputs:{weeks:"weeks"},features:[o.TTD],decls:1,vars:2,consts:[["echarts","",1,"demo-chart",3,"options","merge"]],template:function(u,p){1&u&&o._UZ(0,"div",0),2&u&&o.Q6J("options",p.chartOption)("merge",p.overwrite)},dependencies:[L._w]}),d})();O(4734);let le=(()=>{class d{constructor(){this.weeks=[],this.overwrite={},this.chartOption={tooltip:{trigger:"axis"},legend:{textStyle:{color:"white"},show:!0,type:"scroll"},grid:{left:"3%",right:"4%",bottom:"12%",top:"12%",containLabel:!0},xAxis:[{type:"time",boundaryGap:!1}],darkMode:!0,dataZoom:[{type:"inside"},{type:"slider"}],yAxis:[{alignTicks:!0,boundaryGap:!1,type:"value",max:100,min:0}],series:[]}}ngOnInit(){}ngOnChanges(u){if(0!=this.weeks.length){var p={};for(let M of this.weeks){var A=M.platforms[0].weaponTypes.filter(y=>"NULL"!=y.weaponType).reduce((y,H)=>y+H.kills,0);for(let y of M.platforms[0].weaponTypes){if("NULL"==y.weaponType)continue;null==p[y.weaponType]&&(p[y.weaponType]={name:y.weaponType,type:"line",smooth:!0,stack:"Total",areaStyle:{},emphasis:{focus:"series",blurScope:"coordinateSystem"},data:[]});var U=new Date(Date.parse(M.startDate)),D=[U.getFullYear(),U.getMonth()+1,U.getDate()].join("/");let H=+(y.kills/A*100).toFixed(2);p[y.weaponType].data.push([D,H])}}var B=new Date(Date.parse(this.weeks[10].startDate)-36e3),J=[B.getFullYear(),B.getMonth()+1,B.getDate()].join("/");this.overwrite={dataZoom:[{startValue:J}],series:Object.values(p)}}}}return d.\u0275fac=function(u){return new(u||d)},d.\u0275cmp=o.Xpm({type:d,selectors:[["app-weapon-usage-chart"]],inputs:{weeks:"weeks"},features:[o.TTD],decls:1,vars:2,consts:[["echarts","",1,"demo-chart",3,"options","merge"]],template:function(u,p){1&u&&o._UZ(0,"div",0),2&u&&o.Q6J("options",p.chartOption)("merge",p.overwrite)},dependencies:[L._w],styles:[".demo-chart[_ngcontent-%COMP%]{height:450px}"]}),d})();var m=O(6489),S=O(1109),_=O(6709);let R=(()=>{class d{constructor(u){this.manifest=u,this.overwrite={series:[{}]},this.chartOption={title:{},tooltip:{trigger:"item",confine:!0,formatter:p=>{let A=p.data;var U=(100*A.percent).toFixed(1);return isNaN(A.percent)?`Total: ${A.value.toLocaleString()}`:`${A.name}: ${A.value.toLocaleString()} (${U}%)`}},series:[{data:[],type:"sunburst",center:["48%","55%"],labelLayout:{hideOverlap:!0},label:{overflow:"truncate",rotate:"radial"},levels:[{},{radius:[0,"30%"]},{radius:["30%","90%"]}]}]},this.combine_others=!0}ngOnInit(){}ngOnChanges(u){var p=this;return(0,K.Z)(function*(){yield(0,k.z)(p.manifest.ensureManifestTableExists("DestinyInventoryItemDefinition"));var U=p.week.armor.map(function(){var w=(0,K.Z)(function*(C){return{armor:C,cls:(yield m.s.DestinyInventoryItemDefinition.where("hash").equals(Number.parseInt(C.hash)).first())?.classType}});return function(C){return w.apply(this,arguments)}}()),D=yield Promise.all(U),J=D.filter(w=>0==w.cls).sort((w,C)=>C.armor.amount-w.armor.amount),M=D.filter(w=>2==w.cls).sort((w,C)=>C.armor.amount-w.armor.amount),y=D.filter(w=>1==w.cls).sort((w,C)=>C.armor.amount-w.armor.amount),H=y.reduce((w,C)=>w+C.armor.amount,0),ve=M.reduce((w,C)=>w+C.armor.amount,0),me=J.reduce((w,C)=>w+C.armor.amount,0),j=H+me+ve,fe=w=>w.reduce((C,ae,ce,ge)=>{var ye=C.data.find(Re=>Re.armor.name==ae.armor.name);return ye?ye.armor.amount+=ae.armor.amount:(C.data.push(ae),C.count+=ae.armor.amount),C},Object.assign({},{data:[],count:0})).data;if(y=fe(y),M=fe(M),J=fe(J),p.combine_others){var G=w=>{for(var C=w.reduce((ge,ye)=>ge+ye.armor.amount,0),ae=0,ce=w.length-1;ce>=0&&ae/C<.2;)ae+=w[ce].armor.amount,ce--;return ce},te=(w,C)=>{var ae=w.slice(C+1).reduce((ce,ge)=>(ce.armor.amount+=ge.armor.amount,ce),{cls:void 0,armor:{amount:0,name:"Others"}});return w.slice(0,C+1).concat([ae])};y=te(y,G(y)),M=te(M,G(M)),J=te(J,G(J))}console.log("hunter",y),console.log("warlock",M),console.log("titan",J);var xe=[{name:"Hunter",children:y.map(w=>({name:w.armor.name,value:w.armor.amount,itemStyle:{color:"#77afc0"},percent:w.armor.amount/H})),itemStyle:{color:"#5f9cbb"},percent:H/j},{name:"Warlock",children:M.map(w=>({name:w.armor.name,value:w.armor.amount,itemStyle:{color:"#bdb177"},percent:w.armor.amount/ve})),itemStyle:{color:"#d7c16e"},percent:ve/j},{name:"Titan",children:J.map(w=>({name:w.armor.name,value:w.armor.amount,itemStyle:{color:"#bd7777"},percent:w.armor.amount/me})),itemStyle:{color:"#b76262"},percent:me/j}];p.overwrite={series:[{data:xe}]}})()}toggle_combine(){this.combine_others=!this.combine_others,this.ngOnChanges({})}}return d.\u0275fac=function(u){return new(u||d)(o.Y36(S.W))},d.\u0275cmp=o.Xpm({type:d,selectors:[["app-exotic-armor-usage-pie-chart"]],inputs:{week:"week"},features:[o.TTD],decls:3,vars:3,consts:[["echarts","",1,"demo-chart",3,"options","merge"],[3,"checked","change"]],template:function(u,p){1&u&&(o._UZ(0,"div",0),o.TgZ(1,"mat-checkbox",1),o.NdJ("change",function(){return p.toggle_combine()}),o._uU(2,'Combine small entries to "Others" '),o.qZA()),2&u&&(o.Q6J("options",p.chartOption)("merge",p.overwrite),o.xp6(1),o.Q6J("checked",p.combine_others))},dependencies:[_.oG,L._w]}),d})(),$=(()=>{class d{constructor(){this.week=null,this.overwrite={},this.chartOption={tooltip:{trigger:"item",confine:!0,formatter:u=>{let p=u.data;var A=(100*p.percent).toFixed(1);return`${p.name}: ${p.value.toLocaleString()} (${A}%)`}},series:{data:[],type:"pie",radius:[0,"100%"],labelLayout:{hideOverlap:!0},label:{position:"inside",overflow:"truncate",rotate:"radial"}}}}ngOnInit(){}ngOnChanges(u){var p=this;return(0,K.Z)(function*(){if(p.week){var A=p.week.platforms[0].weaponTypes.reduce((D,B)=>D+B.kills,0),U=p.week.platforms[0].weaponTypes.map(D=>({name:D.weaponType,value:D.kills,percent:D.kills/A,precisionRatio:D.headshots/D.kills})).sort((D,B)=>B.value-D.value);console.log("data",U),p.overwrite={series:{data:U}}}else p.overwrite={}})()}}return d.\u0275fac=function(u){return new(u||d)},d.\u0275cmp=o.Xpm({type:d,selectors:[["app-weapon-usage-pie-chart"]],inputs:{week:"week"},features:[o.TTD],decls:1,vars:2,consts:[["echarts","",1,"demo-chart",3,"options","merge"]],template:function(u,p){1&u&&o._UZ(0,"div",0),2&u&&o.Q6J("options",p.chartOption)("merge",p.overwrite)},dependencies:[L._w]}),d})();function X(d,x){1&d&&(o.TgZ(0,"div",0)(1,"div",5)(2,"mat-icon"),o._uU(3,"dashboard"),o.qZA(),o.TgZ(4,"p"),o._uU(5,"Loading trials information..."),o.qZA()(),o._UZ(6,"mat-icon"),o.qZA())}function q(d,x){if(1&d&&(o.TgZ(0,"div",6)(1,"div",7)(2,"mat-card")(3,"mat-card-title-group")(4,"mat-card-title"),o._uU(5," Trials Subclass usage "),o.qZA(),o.TgZ(6,"mat-card-subtitle"),o._uU(7),o.qZA()(),o._UZ(8,"app-class-and-subclass-chart",8),o.qZA()(),o.TgZ(9,"div",7)(10,"mat-card")(11,"mat-card-title-group")(12,"mat-card-title"),o._uU(13," Trials Exotic armor Usage "),o.qZA(),o.TgZ(14,"mat-card-subtitle"),o._uU(15),o.qZA()(),o._UZ(16,"app-exotic-armor-usage-pie-chart",9),o.qZA()()()),2&d){const u=o.oxw();o.xp6(1),o.Q6J("@fade",void 0),o.xp6(6),o.hij(" Week ",u.week," "),o.xp6(1),o.Q6J("subclassData",u.trialsReportData.subclass),o.xp6(1),o.Q6J("@fade",void 0),o.xp6(6),o.hij(" Week ",u.week," "),o.xp6(1),o.Q6J("week",u.trialsReportData)}}function ee(d,x){if(1&d&&(o.TgZ(0,"div",10)(1,"div",7)(2,"mat-card")(3,"mat-card-title-group")(4,"mat-card-title"),o._uU(5," Trials Class distribution over time "),o.qZA(),o.TgZ(6,"mat-card-subtitle"),o._uU(7),o.qZA()(),o._UZ(8,"app-class-and-subclass-timeline-chart",11),o.qZA()(),o.TgZ(9,"div",7)(10,"mat-card")(11,"mat-card-title-group")(12,"mat-card-title"),o._uU(13," Trials Weapon Type Usage "),o.qZA(),o.TgZ(14,"mat-card-subtitle"),o._uU(15),o.qZA()(),o._UZ(16,"app-weapon-usage-pie-chart",9),o.qZA()()()),2&d){const u=o.oxw();o.xp6(1),o.Q6J("@fade",void 0)("@fade",void 0),o.xp6(6),o.hij(" Weeks 114 to ",u.week," "),o.xp6(1),o.Q6J("weeks",u.previousWeeks),o.xp6(1),o.Q6J("@fade",void 0),o.xp6(6),o.hij(" Week ",u.week," "),o.xp6(1),o.Q6J("week",u.trialsReportData)}}function ue(d,x){if(1&d&&(o.TgZ(0,"div",10)(1,"div",12)(2,"mat-card")(3,"mat-card-title-group")(4,"mat-card-title"),o._uU(5," Trials Weapon Type usage over time "),o.qZA(),o.TgZ(6,"mat-card-subtitle"),o._uU(7),o.qZA()(),o._UZ(8,"app-weapon-usage-chart",11),o.qZA()()()),2&d){const u=o.oxw();o.xp6(1),o.Q6J("@fade",void 0),o.xp6(6),o.hij(" Weeks 1 to ",u.week," "),o.xp6(1),o.Q6J("weeks",u.previousWeeks)}}function he(d,x){1&d&&(o.TgZ(0,"div",10)(1,"div",12)(2,"mat-card")(3,"mat-card-title-group")(4,"mat-card-title"),o._uU(5,"Trials Statistics"),o.qZA(),o.TgZ(6,"mat-card-subtitle"),o._uU(7," Data provided by "),o.TgZ(8,"a",13),o._uU(9,"Trials.Report"),o.qZA(),o._uU(10,". "),o.qZA()()()()())}const Te=[{path:"",component:re.$,children:[{path:"",component:(()=>{class d{constructor(u,p){this.trialsReportApi=u,this._snackBar=p,this.updateStatus={isUpdating:!1,weeksToUpdate:0,updatingWeek:0},this.week=-1,this.previousWeeks=[],this.trialsReportData=void 0,this.db=ne.createInstance({name:"trials-report",storeName:"trials-report"})}ngOnInit(){var u=this;return(0,K.Z)(function*(){u.trialsReportData=yield(0,k.z)(u.trialsReportApi.getMostRecent()),console.log(u.trialsReportData),u.week=u.trialsReportData.weekNumber;var p=u._snackBar.openFromComponent(Q,{data:"",horizontalPosition:"right",verticalPosition:"top"});u.updateStatus.weeksToUpdate=u.week-1,u.updateStatus.updatingWeek=0,u.updateStatus.isUpdating=!0;var A=[];for(let D=u.week-1;D>=1;D--)A.push(u.getWeek(D).then(B=>(u.updateStatus.updatingWeek++,p.instance.data=`Fetching Trials data (${u.updateStatus.updatingWeek} of ${u.updateStatus.weeksToUpdate})`,B)));var U=yield Promise.all(A);u.updateStatus.isUpdating=!1,p.dismiss(),console.log("this.trialsReportData",u.trialsReportData),u.previousWeeks=[u.trialsReportData].concat(U)})()}getWeek(u){var p=this;return(0,K.Z)(function*(){let A="trialsreport-week-"+u;null!=localStorage.getItem(A)&&localStorage.removeItem(A);var U=yield p.db.getItem(A).then(B=>B?JSON.parse(B):null);if(null!=U)return U;const D=yield(0,k.z)(p.trialsReportApi.getApiData(u));return yield p.db.setItem(A,JSON.stringify(D)),D})()}}return d.\u0275fac=function(u){return new(u||d)(o.Y36(b),o.Y36(z.ux))},d.\u0275cmp=o.Xpm({type:d,selectors:[["app-trials-data-report"]],decls:7,vars:5,consts:[["fxLayout","row","fxLayoutAlign","center none",1,"container"],["fxFlex","95%"],["class","container","fxLayout","row","fxLayoutAlign","center none",4,"ngIf"],["class","container","fxLayout","row","fxLayout.sm","column","fxLayout.xs","column","fxLayoutAlign","center none","fxLayoutGap","15px",4,"ngIf"],["class","container","fxLayout","row","fxLayout.sm","column","fxLayout.xs","column","fxLayoutAlign","center none","fxLayoutGap","5px",4,"ngIf"],["fxFlex","50%",1,"text-center","no-records","animate"],["fxLayout","row","fxLayout.sm","column","fxLayout.xs","column","fxLayoutAlign","center none","fxLayoutGap","15px",1,"container"],["fxFlex","50%","fxFlex.gt-lg","50%","fxFlex.sm","100%","fxFlex.xs","100%"],["mat-card-image","",3,"subclassData"],[3,"week"],["fxLayout","row","fxLayout.sm","column","fxLayout.xs","column","fxLayoutAlign","center none","fxLayoutGap","5px",1,"container"],[3,"weeks"],["fxFlex","100%","fxFlex.gt-lg","100%","fxFlex.sm","100%","fxFlex.xs","100%"],["href","https://trials.report",1,"accent-color"]],template:function(u,p){1&u&&(o.TgZ(0,"div",0)(1,"div",1),o.YNc(2,X,7,0,"div",2),o.YNc(3,q,17,6,"div",3),o.YNc(4,ee,17,7,"div",4),o.YNc(5,ue,9,3,"div",4),o.YNc(6,he,11,0,"div",4),o.qZA()()),2&u&&(o.xp6(2),o.Q6J("ngIf",-1==p.week),o.xp6(1),o.Q6J("ngIf",p.trialsReportData),o.xp6(1),o.Q6J("ngIf",p.trialsReportData),o.xp6(1),o.Q6J("ngIf",p.trialsReportData),o.xp6(1),o.Q6J("ngIf",p.trialsReportData))},dependencies:[Ee.O5,F.Hw,P.a8,P.C1,P.n5,P.$j,P.G2,V.xw,V.SQ,V.Wh,V.yH,se,W,le,R,$],styles:[".theme-titan[_ngcontent-%COMP%]   .pageHeader[_ngcontent-%COMP%]{background-color:#d32f2f}  .theme-titan .pageHeader{background-color:#d32f2f}.theme-warlock[_ngcontent-%COMP%]   .pageHeader[_ngcontent-%COMP%]{background-color:#ffa000}  .theme-warlock .pageHeader{background-color:#ffa000}.theme-hunter[_ngcontent-%COMP%]   .pageHeader[_ngcontent-%COMP%]{background-color:#1976d2}  .theme-hunter .pageHeader{background-color:#1976d2}mat-card[_ngcontent-%COMP%]{margin-bottom:5px}.container1[_ngcontent-%COMP%]{font-size:16px;font-family:Roboto,Helvetica Neue,sans-serif}.chart-container[_ngcontent-%COMP%]{border-radius:5px;border:1px solid rgba(255,255,255,.2)}"],data:{animation:[(0,N.X$)("fade",[(0,N.eR)(":enter",[(0,N.oB)({opacity:0}),(0,N.jt)(300,(0,N.oB)({opacity:1}))]),(0,N.eR)(":leave",[(0,N.oB)({opacity:1}),(0,N.jt)(300,(0,N.oB)({opacity:0}))])])]}}),d})()}]}];let de=(()=>{class d{}return d.\u0275fac=function(u){return new(u||d)},d.\u0275mod=o.oAB({type:d}),d.\u0275inj=o.cJS({imports:[ie.Bz.forChild(Te),ie.Bz]}),d})();var Ie=O(5823),Ne=O(951);let Oe=(()=>{class d{}return d.\u0275fac=function(u){return new(u||d)},d.\u0275mod=o.oAB({type:d}),d.\u0275inj=o.cJS({providers:[b],imports:[Ee.ez,Ne.S,de,Ie.o9,L.Ns.forRoot({echarts:()=>Promise.resolve().then(O.bind(O,4734))})]}),d})()},4424:Ze=>{Ze.exports=function ie(re,K,k){function z(N,ne){if(!K[N]){if(!re[N]){if(o)return o(N,!0);var b=new Error("Cannot find module '"+N+"'");throw b.code="MODULE_NOT_FOUND",b}var F=K[N]={exports:{}};re[N][0].call(F.exports,function(P){return z(re[N][1][P]||P)},F,F.exports,ie,re,K,k)}return K[N].exports}for(var o=void 0,Q=0;Q<k.length;Q++)z(k[Q]);return z}({1:[function(ie,re,K){(function(k){"use strict";var o,z=k.MutationObserver||k.WebKitMutationObserver;if(z){var Q=0,N=new z(P),ne=k.document.createTextNode("");N.observe(ne,{characterData:!0}),o=function(){ne.data=Q=++Q%2}}else if(!k.setImmediate&&typeof k.MessageChannel<"u"){var h=new k.MessageChannel;h.port1.onmessage=P,o=function(){h.port2.postMessage(0)}}else o="document"in k&&"onreadystatechange"in k.document.createElement("script")?function(){var L=k.document.createElement("script");L.onreadystatechange=function(){P(),L.onreadystatechange=null,L.parentNode.removeChild(L),L=null},k.document.documentElement.appendChild(L)}:function(){setTimeout(P,0)};var b,F=[];function P(){b=!0;for(var L,se,W=F.length;W;){for(se=F,F=[],L=-1;++L<W;)se[L]();W=F.length}b=!1}re.exports=function V(L){1===F.push(L)&&!b&&o()}}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{}],2:[function(ie,re,K){"use strict";var k=ie(1);function z(){}var o={},Q=["REJECTED"],N=["FULFILLED"],ne=["PENDING"];function h(m){if("function"!=typeof m)throw new TypeError("resolver must be a function");this.state=ne,this.queue=[],this.outcome=void 0,m!==z&&V(this,m)}function b(m,S,_){this.promise=m,"function"==typeof S&&(this.onFulfilled=S,this.callFulfilled=this.otherCallFulfilled),"function"==typeof _&&(this.onRejected=_,this.callRejected=this.otherCallRejected)}function F(m,S,_){k(function(){var R;try{R=S(_)}catch($){return o.reject(m,$)}R===m?o.reject(m,new TypeError("Cannot resolve promise with itself")):o.resolve(m,R)})}function P(m){var S=m&&m.then;if(m&&("object"==typeof m||"function"==typeof m)&&"function"==typeof S)return function(){S.apply(m,arguments)}}function V(m,S){var _=!1;function R(ee){_||(_=!0,o.reject(m,ee))}function $(ee){_||(_=!0,o.resolve(m,ee))}var q=L(function X(){S($,R)});"error"===q.status&&R(q.value)}function L(m,S){var _={};try{_.value=m(S),_.status="success"}catch(R){_.status="error",_.value=R}return _}re.exports=h,h.prototype.catch=function(m){return this.then(null,m)},h.prototype.then=function(m,S){if("function"!=typeof m&&this.state===N||"function"!=typeof S&&this.state===Q)return this;var _=new this.constructor(z);return this.state!==ne?F(_,this.state===N?m:S,this.outcome):this.queue.push(new b(_,m,S)),_},b.prototype.callFulfilled=function(m){o.resolve(this.promise,m)},b.prototype.otherCallFulfilled=function(m){F(this.promise,this.onFulfilled,m)},b.prototype.callRejected=function(m){o.reject(this.promise,m)},b.prototype.otherCallRejected=function(m){F(this.promise,this.onRejected,m)},o.resolve=function(m,S){var _=L(P,S);if("error"===_.status)return o.reject(m,_.value);var R=_.value;if(R)V(m,R);else{m.state=N,m.outcome=S;for(var $=-1,X=m.queue.length;++$<X;)m.queue[$].callFulfilled(S)}return m},o.reject=function(m,S){m.state=Q,m.outcome=S;for(var _=-1,R=m.queue.length;++_<R;)m.queue[_].callRejected(S);return m},h.resolve=function se(m){return m instanceof this?m:o.resolve(new this(z),m)},h.reject=function W(m){var S=new this(z);return o.reject(S,m)},h.all=function Ae(m){var S=this;if("[object Array]"!==Object.prototype.toString.call(m))return this.reject(new TypeError("must be an array"));var _=m.length,R=!1;if(!_)return this.resolve([]);for(var $=new Array(_),X=0,q=-1,ee=new this(z);++q<_;)ue(m[q],q);return ee;function ue(he,be){S.resolve(he).then(function Te(de){$[be]=de,++X===_&&!R&&(R=!0,o.resolve(ee,$))},function(de){R||(R=!0,o.reject(ee,de))})}},h.race=function le(m){var S=this;if("[object Array]"!==Object.prototype.toString.call(m))return this.reject(new TypeError("must be an array"));var _=m.length,R=!1;if(!_)return this.resolve([]);for(var $=-1,X=new this(z);++$<_;)S.resolve(m[$]).then(function(ue){R||(R=!0,o.resolve(X,ue))},function(ue){R||(R=!0,o.reject(X,ue))});return X}},{1:1}],3:[function(ie,re,K){(function(k){"use strict";"function"!=typeof k.Promise&&(k.Promise=ie(2))}).call(this,typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{})},{2:2}],4:[function(ie,re,K){"use strict";var k="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};var Q=function o(){try{if(typeof indexedDB<"u")return indexedDB;if(typeof webkitIndexedDB<"u")return webkitIndexedDB;if(typeof mozIndexedDB<"u")return mozIndexedDB;if(typeof OIndexedDB<"u")return OIndexedDB;if(typeof msIndexedDB<"u")return msIndexedDB}catch{return}}();function ne(e,r){e=e||[],r=r||{};try{return new Blob(e,r)}catch(n){if("TypeError"!==n.name)throw n;for(var a=new(typeof BlobBuilder<"u"?BlobBuilder:typeof MSBlobBuilder<"u"?MSBlobBuilder:typeof MozBlobBuilder<"u"?MozBlobBuilder:WebKitBlobBuilder),i=0;i<e.length;i+=1)a.append(e[i]);return a.getBlob(r.type)}}typeof Promise>"u"&&ie(3);var h=Promise;function b(e,r){r&&e.then(function(t){r(null,t)},function(t){r(t)})}function F(e,r,t){"function"==typeof r&&e.then(r),"function"==typeof t&&e.catch(t)}function P(e){return"string"!=typeof e&&(console.warn(e+" used as a key, but it is not a string."),e=String(e)),e}function V(){if(arguments.length&&"function"==typeof arguments[arguments.length-1])return arguments[arguments.length-1]}var L="local-forage-detect-blob-support",se=void 0,W={},Ae=Object.prototype.toString,le="readonly",m="readwrite";function S(e){for(var r=e.length,t=new ArrayBuffer(r),a=new Uint8Array(t),i=0;i<r;i++)a[i]=e.charCodeAt(i);return t}function R(e){return"boolean"==typeof se?h.resolve(se):function _(e){return new h(function(r){var t=e.transaction(L,m),a=ne([""]);t.objectStore(L).put(a,"key"),t.onabort=function(i){i.preventDefault(),i.stopPropagation(),r(!1)},t.oncomplete=function(){var i=navigator.userAgent.match(/Chrome\/(\d+)/),n=navigator.userAgent.match(/Edge\//);r(n||!i||parseInt(i[1],10)>=43)}}).catch(function(){return!1})}(e).then(function(r){return se=r})}function $(e){var r=W[e.name],t={};t.promise=new h(function(a,i){t.resolve=a,t.reject=i}),r.deferredOperations.push(t),r.dbReady=r.dbReady?r.dbReady.then(function(){return t.promise}):t.promise}function X(e){var t=W[e.name].deferredOperations.pop();if(t)return t.resolve(),t.promise}function q(e,r){var a=W[e.name].deferredOperations.pop();if(a)return a.reject(r),a.promise}function ee(e,r){return new h(function(t,a){if(W[e.name]=W[e.name]||{forages:[],db:null,dbReady:null,deferredOperations:[]},e.db){if(!r)return t(e.db);$(e),e.db.close()}var i=[e.name];r&&i.push(e.version);var n=Q.open.apply(Q,i);r&&(n.onupgradeneeded=function(s){var c=n.result;try{c.createObjectStore(e.storeName),s.oldVersion<=1&&c.createObjectStore(L)}catch(f){if("ConstraintError"!==f.name)throw f;console.warn('The database "'+e.name+'" has been upgraded from version '+s.oldVersion+" to version "+s.newVersion+', but the storage "'+e.storeName+'" already exists.')}}),n.onerror=function(s){s.preventDefault(),a(n.error)},n.onsuccess=function(){var s=n.result;s.onversionchange=function(c){c.target.close()},t(s),X(e)}})}function ue(e){return ee(e,!1)}function he(e){return ee(e,!0)}function be(e,r){if(!e.db)return!0;var t=!e.db.objectStoreNames.contains(e.storeName),i=e.version>e.db.version;if(e.version<e.db.version&&(e.version!==r&&console.warn('The database "'+e.name+"\" can't be downgraded from version "+e.db.version+" to version "+e.version+"."),e.version=e.db.version),i||t){if(t){var n=e.db.version+1;n>e.version&&(e.version=n)}return!0}return!1}function de(e){return ne([S(atob(e.data))],{type:e.type})}function Ie(e){return e&&e.__local_forage_encoded_blob}function Ne(e){var r=this,t=r._initReady().then(function(){var a=W[r._dbInfo.name];if(a&&a.dbReady)return a.dbReady});return F(t,e,e),t}function d(e,r,t,a){void 0===a&&(a=1);try{var i=e.db.transaction(e.storeName,r);t(null,i)}catch(n){if(a>0&&(!e.db||"InvalidStateError"===n.name||"NotFoundError"===n.name))return h.resolve().then(function(){if(!e.db||"NotFoundError"===n.name&&!e.db.objectStoreNames.contains(e.storeName)&&e.version<=e.db.version)return e.db&&(e.version=e.db.version+1),he(e)}).then(function(){return function Oe(e){$(e);for(var r=W[e.name],t=r.forages,a=0;a<t.length;a++){var i=t[a];i._dbInfo.db&&(i._dbInfo.db.close(),i._dbInfo.db=null)}return e.db=null,ue(e).then(function(n){return e.db=n,be(e)?he(e):n}).then(function(n){e.db=r.db=n;for(var s=0;s<t.length;s++)t[s]._dbInfo.db=n}).catch(function(n){throw q(e,n),n})}(e).then(function(){d(e,r,t,a-1)})}).catch(t);t(n)}}var ve={_driver:"asyncStorage",_initStorage:function u(e){var r=this,t={db:null};if(e)for(var a in e)t[a]=e[a];var i=W[t.name];i||(W[t.name]=i={forages:[],db:null,dbReady:null,deferredOperations:[]}),i.forages.push(r),r._initReady||(r._initReady=r.ready,r.ready=Ne);var n=[];function s(){return h.resolve()}for(var c=0;c<i.forages.length;c++){var f=i.forages[c];f!==r&&n.push(f._initReady().catch(s))}var l=i.forages.slice(0);return h.all(n).then(function(){return t.db=i.db,ue(t)}).then(function(v){return t.db=v,be(t,r._defaultConfig.version)?he(t):v}).then(function(v){t.db=i.db=v,r._dbInfo=t;for(var g=0;g<l.length;g++){var T=l[g];T!==r&&(T._dbInfo.db=t.db,T._dbInfo.version=t.version)}})},_support:function N(){try{if(!Q||!Q.open)return!1;var e=typeof openDatabase<"u"&&/(Safari|iPhone|iPad|iPod)/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent)&&!/BlackBerry/.test(navigator.platform),r="function"==typeof fetch&&-1!==fetch.toString().indexOf("[native code");return(!e||r)&&typeof indexedDB<"u"&&typeof IDBKeyRange<"u"}catch{return!1}}(),iterate:function A(e,r){var t=this,a=new h(function(i,n){t.ready().then(function(){d(t._dbInfo,le,function(s,c){if(s)return n(s);try{var l=c.objectStore(t._dbInfo.storeName).openCursor(),v=1;l.onsuccess=function(){var g=l.result;if(g){var T=g.value;Ie(T)&&(T=de(T));var I=e(T,g.key,v++);void 0!==I?i(I):g.continue()}else i()},l.onerror=function(){n(l.error)}}catch(g){n(g)}})}).catch(n)});return b(a,r),a},getItem:function p(e,r){var t=this;e=P(e);var a=new h(function(i,n){t.ready().then(function(){d(t._dbInfo,le,function(s,c){if(s)return n(s);try{var l=c.objectStore(t._dbInfo.storeName).get(e);l.onsuccess=function(){var v=l.result;void 0===v&&(v=null),Ie(v)&&(v=de(v)),i(v)},l.onerror=function(){n(l.error)}}catch(v){n(v)}})}).catch(n)});return b(a,r),a},setItem:function U(e,r,t){var a=this;e=P(e);var i=new h(function(n,s){var c;a.ready().then(function(){return c=a._dbInfo,"[object Blob]"===Ae.call(r)?R(c.db).then(function(f){return f?r:function Te(e){return new h(function(r,t){var a=new FileReader;a.onerror=t,a.onloadend=function(i){var n=btoa(i.target.result||"");r({__local_forage_encoded_blob:!0,data:n,type:e.type})},a.readAsBinaryString(e)})}(r)}):r}).then(function(f){d(a._dbInfo,m,function(l,v){if(l)return s(l);try{var g=v.objectStore(a._dbInfo.storeName);null===f&&(f=void 0);var T=g.put(f,e);v.oncomplete=function(){void 0===f&&(f=null),n(f)},v.onabort=v.onerror=function(){s(T.error?T.error:T.transaction.error)}}catch(I){s(I)}})}).catch(s)});return b(i,t),i},removeItem:function D(e,r){var t=this;e=P(e);var a=new h(function(i,n){t.ready().then(function(){d(t._dbInfo,m,function(s,c){if(s)return n(s);try{var l=c.objectStore(t._dbInfo.storeName).delete(e);c.oncomplete=function(){i()},c.onerror=function(){n(l.error)},c.onabort=function(){n(l.error?l.error:l.transaction.error)}}catch(v){n(v)}})}).catch(n)});return b(a,r),a},clear:function B(e){var r=this,t=new h(function(a,i){r.ready().then(function(){d(r._dbInfo,m,function(n,s){if(n)return i(n);try{var f=s.objectStore(r._dbInfo.storeName).clear();s.oncomplete=function(){a()},s.onabort=s.onerror=function(){i(f.error?f.error:f.transaction.error)}}catch(l){i(l)}})}).catch(i)});return b(t,e),t},length:function J(e){var r=this,t=new h(function(a,i){r.ready().then(function(){d(r._dbInfo,le,function(n,s){if(n)return i(n);try{var f=s.objectStore(r._dbInfo.storeName).count();f.onsuccess=function(){a(f.result)},f.onerror=function(){i(f.error)}}catch(l){i(l)}})}).catch(i)});return b(t,e),t},key:function M(e,r){var t=this,a=new h(function(i,n){e<0?i(null):t.ready().then(function(){d(t._dbInfo,le,function(s,c){if(s)return n(s);try{var f=c.objectStore(t._dbInfo.storeName),l=!1,v=f.openKeyCursor();v.onsuccess=function(){var g=v.result;g?0===e||l?i(g.key):(l=!0,g.advance(e)):i(null)},v.onerror=function(){n(v.error)}}catch(g){n(g)}})}).catch(n)});return b(a,r),a},keys:function y(e){var r=this,t=new h(function(a,i){r.ready().then(function(){d(r._dbInfo,le,function(n,s){if(n)return i(n);try{var f=s.objectStore(r._dbInfo.storeName).openKeyCursor(),l=[];f.onsuccess=function(){var v=f.result;v?(l.push(v.key),v.continue()):a(l)},f.onerror=function(){i(f.error)}}catch(v){i(v)}})}).catch(i)});return b(t,e),t},dropInstance:function H(e,r){r=V.apply(this,arguments);var t=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||t.name,e.storeName=e.storeName||t.storeName);var i,a=this;if(e.name){var s=e.name===t.name&&a._dbInfo.db?h.resolve(a._dbInfo.db):ue(e).then(function(c){var f=W[e.name],l=f.forages;f.db=c;for(var v=0;v<l.length;v++)l[v]._dbInfo.db=c;return c});i=s.then(e.storeName?function(c){if(c.objectStoreNames.contains(e.storeName)){var f=c.version+1;$(e);var l=W[e.name],v=l.forages;c.close();for(var g=0;g<v.length;g++){var T=v[g];T._dbInfo.db=null,T._dbInfo.version=f}return new h(function(E,Y){var Z=Q.open(e.name,f);Z.onerror=function(oe){Z.result.close(),Y(oe)},Z.onupgradeneeded=function(){Z.result.deleteObjectStore(e.storeName)},Z.onsuccess=function(){var oe=Z.result;oe.close(),E(oe)}}).then(function(E){l.db=E;for(var Y=0;Y<v.length;Y++){var Z=v[Y];Z._dbInfo.db=E,X(Z._dbInfo)}}).catch(function(E){throw(q(e,E)||h.resolve()).catch(function(){}),E})}}:function(c){$(e);var f=W[e.name],l=f.forages;c.close();for(var v=0;v<l.length;v++)l[v]._dbInfo.db=null;return new h(function(I,E){var Y=Q.deleteDatabase(e.name);Y.onerror=function(){var Z=Y.result;Z&&Z.close(),E(Y.error)},Y.onblocked=function(){console.warn('dropInstance blocked for database "'+e.name+'" until all open connections are closed')},Y.onsuccess=function(){var Z=Y.result;Z&&Z.close(),I(Z)}}).then(function(I){f.db=I;for(var E=0;E<l.length;E++)X(l[E]._dbInfo)}).catch(function(I){throw(q(e,I)||h.resolve()).catch(function(){}),I})})}else i=h.reject("Invalid arguments");return b(i,r),i}};var j="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",G=/^~~local_forage_type~([^~]+)~/,te="__lfsc__:",xe=te.length,w="arbf",C="blob",ze=xe+w.length,Qe=Object.prototype.toString;function Je(e){var a,n,s,c,f,r=.75*e.length,t=e.length,i=0;"="===e[e.length-1]&&(r--,"="===e[e.length-2]&&r--);var l=new ArrayBuffer(r),v=new Uint8Array(l);for(a=0;a<t;a+=4)n=j.indexOf(e[a]),s=j.indexOf(e[a+1]),c=j.indexOf(e[a+2]),f=j.indexOf(e[a+3]),v[i++]=n<<2|s>>4,v[i++]=(15&s)<<4|c>>2,v[i++]=(3&c)<<6|63&f;return l}function Le(e){var a,r=new Uint8Array(e),t="";for(a=0;a<r.length;a+=3)t+=j[r[a]>>2],t+=j[(3&r[a])<<4|r[a+1]>>4],t+=j[(15&r[a+1])<<2|r[a+2]>>6],t+=j[63&r[a+2]];return r.length%3==2?t=t.substring(0,t.length-1)+"=":r.length%3==1&&(t=t.substring(0,t.length-2)+"=="),t}var ke={serialize:function qe(e,r){var t="";if(e&&(t=Qe.call(e)),e&&("[object ArrayBuffer]"===t||e.buffer&&"[object ArrayBuffer]"===Qe.call(e.buffer))){var a,i=te;e instanceof ArrayBuffer?(a=e,i+=w):(a=e.buffer,"[object Int8Array]"===t?i+="si08":"[object Uint8Array]"===t?i+="ui08":"[object Uint8ClampedArray]"===t?i+="uic8":"[object Int16Array]"===t?i+="si16":"[object Uint16Array]"===t?i+="ur16":"[object Int32Array]"===t?i+="si32":"[object Uint32Array]"===t?i+="ui32":"[object Float32Array]"===t?i+="fl32":"[object Float64Array]"===t?i+="fl64":r(new Error("Failed to get type for BinaryArray"))),r(i+Le(a))}else if("[object Blob]"===t){var n=new FileReader;n.onload=function(){var s="~~local_forage_type~"+e.type+"~"+Le(this.result);r(te+C+s)},n.readAsArrayBuffer(e)}else try{r(JSON.stringify(e))}catch(s){console.error("Couldn't convert value into a JSON string: ",e),r(null,s)}},deserialize:function et(e){if(e.substring(0,xe)!==te)return JSON.parse(e);var a,r=e.substring(ze),t=e.substring(xe,ze);if(t===C&&G.test(r)){var i=r.match(G);a=i[1],r=r.substring(i[0].length)}var n=Je(r);switch(t){case w:return n;case C:return ne([n],{type:a});case"si08":return new Int8Array(n);case"ui08":return new Uint8Array(n);case"uic8":return new Uint8ClampedArray(n);case"si16":return new Int16Array(n);case"ur16":return new Uint16Array(n);case"si32":return new Int32Array(n);case"ui32":return new Uint32Array(n);case"fl32":return new Float32Array(n);case"fl64":return new Float64Array(n);default:throw new Error("Unkown type: "+t)}},stringToBuffer:Je,bufferToString:Le};function He(e,r,t,a){e.executeSql("CREATE TABLE IF NOT EXISTS "+r.storeName+" (id INTEGER PRIMARY KEY, key unique, value)",[],t,a)}function pe(e,r,t,a,i,n){e.executeSql(t,a,i,function(s,c){c.code===c.SYNTAX_ERR?s.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name = ?",[r.storeName],function(f,l){l.rows.length?n(f,c):He(f,r,function(){f.executeSql(t,a,i,n)},n)},n):n(s,c)},n)}function Ge(e,r,t,a){var i=this;e=P(e);var n=new h(function(s,c){i.ready().then(function(){void 0===r&&(r=null);var f=r,l=i._dbInfo;l.serializer.serialize(r,function(v,g){g?c(g):l.db.transaction(function(T){pe(T,l,"INSERT OR REPLACE INTO "+l.storeName+" (key, value) VALUES (?, ?)",[e,v],function(){s(f)},function(I,E){c(E)})},function(T){if(T.code===T.QUOTA_ERR){if(a>0)return void s(Ge.apply(i,[e,f,t,a-1]));c(T)}})})}).catch(c)});return b(n,t),n}function ft(e){return new h(function(r,t){e.transaction(function(a){a.executeSql("SELECT name FROM sqlite_master WHERE type='table' AND name <> '__WebKitDatabaseInfoTable__'",[],function(i,n){for(var s=[],c=0;c<n.rows.length;c++)s.push(n.rows.item(c).name);r({db:e,storeNames:s})},function(i,n){t(n)})},function(a){t(a)})})}var dt={_driver:"webSQLStorage",_initStorage:function tt(e){var r=this,t={db:null};if(e)for(var a in e)t[a]="string"!=typeof e[a]?e[a].toString():e[a];var i=new h(function(n,s){try{t.db=openDatabase(t.name,String(t.version),t.description,t.size)}catch(c){return s(c)}t.db.transaction(function(c){He(c,t,function(){r._dbInfo=t,n()},function(f,l){s(l)})},s)});return t.serializer=ke,i},_support:function me(){return"function"==typeof openDatabase}(),iterate:function nt(e,r){var t=this,a=new h(function(i,n){t.ready().then(function(){var s=t._dbInfo;s.db.transaction(function(c){pe(c,s,"SELECT * FROM "+s.storeName,[],function(f,l){for(var v=l.rows,g=v.length,T=0;T<g;T++){var I=v.item(T),E=I.value;if(E&&(E=s.serializer.deserialize(E)),void 0!==(E=e(E,I.key,T+1)))return void i(E)}i()},function(f,l){n(l)})})}).catch(n)});return b(a,r),a},getItem:function rt(e,r){var t=this;e=P(e);var a=new h(function(i,n){t.ready().then(function(){var s=t._dbInfo;s.db.transaction(function(c){pe(c,s,"SELECT * FROM "+s.storeName+" WHERE key = ? LIMIT 1",[e],function(f,l){var v=l.rows.length?l.rows.item(0).value:null;v&&(v=s.serializer.deserialize(v)),i(v)},function(f,l){n(l)})})}).catch(n)});return b(a,r),a},setItem:function at(e,r,t){return Ge.apply(this,[e,r,t,1])},removeItem:function ot(e,r){var t=this;e=P(e);var a=new h(function(i,n){t.ready().then(function(){var s=t._dbInfo;s.db.transaction(function(c){pe(c,s,"DELETE FROM "+s.storeName+" WHERE key = ?",[e],function(){i()},function(f,l){n(l)})})}).catch(n)});return b(a,r),a},clear:function it(e){var r=this,t=new h(function(a,i){r.ready().then(function(){var n=r._dbInfo;n.db.transaction(function(s){pe(s,n,"DELETE FROM "+n.storeName,[],function(){a()},function(c,f){i(f)})})}).catch(i)});return b(t,e),t},length:function st(e){var r=this,t=new h(function(a,i){r.ready().then(function(){var n=r._dbInfo;n.db.transaction(function(s){pe(s,n,"SELECT COUNT(key) as c FROM "+n.storeName,[],function(c,f){var l=f.rows.item(0).c;a(l)},function(c,f){i(f)})})}).catch(i)});return b(t,e),t},key:function ut(e,r){var t=this,a=new h(function(i,n){t.ready().then(function(){var s=t._dbInfo;s.db.transaction(function(c){pe(c,s,"SELECT key FROM "+s.storeName+" WHERE id = ? LIMIT 1",[e+1],function(f,l){var v=l.rows.length?l.rows.item(0).key:null;i(v)},function(f,l){n(l)})})}).catch(n)});return b(a,r),a},keys:function ct(e){var r=this,t=new h(function(a,i){r.ready().then(function(){var n=r._dbInfo;n.db.transaction(function(s){pe(s,n,"SELECT key FROM "+n.storeName,[],function(c,f){for(var l=[],v=0;v<f.rows.length;v++)l.push(f.rows.item(v).key);a(l)},function(c,f){i(f)})})}).catch(i)});return b(t,e),t},dropInstance:function lt(e,r){r=V.apply(this,arguments);var t=this.config();(e="function"!=typeof e&&e||{}).name||(e.name=e.name||t.name,e.storeName=e.storeName||t.storeName);var i,a=this;return b(i=e.name?new h(function(n){var s;s=e.name===t.name?a._dbInfo.db:openDatabase(e.name,"","",0),n(e.storeName?{db:s,storeNames:[e.storeName]}:ft(s))}).then(function(n){return new h(function(s,c){n.db.transaction(function(f){function l(I){return new h(function(E,Y){f.executeSql("DROP TABLE IF EXISTS "+I,[],function(){E()},function(Z,oe){Y(oe)})})}for(var v=[],g=0,T=n.storeNames.length;g<T;g++)v.push(l(n.storeNames[g]));h.all(v).then(function(){s()}).catch(function(I){c(I)})},function(f){c(f)})})}):h.reject("Invalid arguments"),r),i}};function je(e,r){var t=e.name+"/";return e.storeName!==r.storeName&&(t+=e.storeName+"/"),t}function pt(){return!function mt(){var e="_localforage_support_test";try{return localStorage.setItem(e,!0),localStorage.removeItem(e),!1}catch{return!0}}()||localStorage.length>0}var At={_driver:"localStorageWrapper",_initStorage:function ht(e){var t={};if(e)for(var a in e)t[a]=e[a];return t.keyPrefix=je(e,this._defaultConfig),pt()?(this._dbInfo=t,t.serializer=ke,h.resolve()):h.reject()},_support:function vt(){try{return typeof localStorage<"u"&&"setItem"in localStorage&&!!localStorage.setItem}catch{return!1}}(),iterate:function bt(e,r){var t=this,a=t.ready().then(function(){for(var i=t._dbInfo,n=i.keyPrefix,s=n.length,c=localStorage.length,f=1,l=0;l<c;l++){var v=localStorage.key(l);if(0===v.indexOf(n)){var g=localStorage.getItem(v);if(g&&(g=i.serializer.deserialize(g)),void 0!==(g=e(g,v.substring(s),f++)))return g}}});return b(a,r),a},getItem:function yt(e,r){var t=this;e=P(e);var a=t.ready().then(function(){var i=t._dbInfo,n=localStorage.getItem(i.keyPrefix+e);return n&&(n=i.serializer.deserialize(n)),n});return b(a,r),a},setItem:function St(e,r,t){var a=this;e=P(e);var i=a.ready().then(function(){void 0===r&&(r=null);var n=r;return new h(function(s,c){var f=a._dbInfo;f.serializer.serialize(r,function(l,v){if(v)c(v);else try{localStorage.setItem(f.keyPrefix+e,l),s(n)}catch(g){("QuotaExceededError"===g.name||"NS_ERROR_DOM_QUOTA_REACHED"===g.name)&&c(g),c(g)}})})});return b(i,t),i},removeItem:function xt(e,r){var t=this;e=P(e);var a=t.ready().then(function(){localStorage.removeItem(t._dbInfo.keyPrefix+e)});return b(a,r),a},clear:function gt(e){var r=this,t=r.ready().then(function(){for(var a=r._dbInfo.keyPrefix,i=localStorage.length-1;i>=0;i--){var n=localStorage.key(i);0===n.indexOf(a)&&localStorage.removeItem(n)}});return b(t,e),t},length:function Tt(e){var t=this.keys().then(function(a){return a.length});return b(t,e),t},key:function wt(e,r){var t=this,a=t.ready().then(function(){var n,i=t._dbInfo;try{n=localStorage.key(e)}catch{n=null}return n&&(n=n.substring(i.keyPrefix.length)),n});return b(a,r),a},keys:function _t(e){var r=this,t=r.ready().then(function(){for(var a=r._dbInfo,i=localStorage.length,n=[],s=0;s<i;s++){var c=localStorage.key(s);0===c.indexOf(a.keyPrefix)&&n.push(c.substring(a.keyPrefix.length))}return n});return b(t,e),t},dropInstance:function Dt(e,r){if(r=V.apply(this,arguments),!(e="function"!=typeof e&&e||{}).name){var t=this.config();e.name=e.name||t.name,e.storeName=e.storeName||t.storeName}var i,a=this;return b(i=e.name?new h(function(n){n(e.storeName?je(e,a._defaultConfig):e.name+"/")}).then(function(n){for(var s=localStorage.length-1;s>=0;s--){var c=localStorage.key(s);0===c.indexOf(n)&&localStorage.removeItem(c)}}):h.reject("Invalid arguments"),r),i}},It=function(r,t){return r===t||"number"==typeof r&&"number"==typeof t&&isNaN(r)&&isNaN(t)},Rt=function(r,t){for(var a=r.length,i=0;i<a;){if(It(r[i],t))return!0;i++}return!1},Ve=Array.isArray||function(e){return"[object Array]"===Object.prototype.toString.call(e)},Se={},Xe={},we={INDEXEDDB:ve,WEBSQL:dt,LOCALSTORAGE:At},Ct=[we.INDEXEDDB._driver,we.WEBSQL._driver,we.LOCALSTORAGE._driver],Ce=["dropInstance"],Pe=["clear","getItem","iterate","key","keys","length","removeItem","setItem"].concat(Ce),Et={description:"",driver:Ct.slice(),name:"localforage",size:4980736,storeName:"keyvaluepairs",version:1};function Nt(e,r){e[r]=function(){var t=arguments;return e.ready().then(function(){return e[r].apply(e,t)})}}function Be(){for(var e=1;e<arguments.length;e++){var r=arguments[e];if(r)for(var t in r)r.hasOwnProperty(t)&&(arguments[0][t]=Ve(r[t])?r[t].slice():r[t])}return arguments[0]}var Ot=function(){function e(r){for(var t in function z(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}(this,e),we)if(we.hasOwnProperty(t)){var a=we[t],i=a._driver;this[t]=i,Se[i]||this.defineDriver(a)}this._defaultConfig=Be({},Et),this._config=Be({},this._defaultConfig,r),this._driverSet=null,this._initDriver=null,this._ready=!1,this._dbInfo=null,this._wrapLibraryMethodsWithReady(),this.setDriver(this._config.driver).catch(function(){})}return e.prototype.config=function(t){if("object"===(typeof t>"u"?"undefined":k(t))){if(this._ready)return new Error("Can't call config() after localforage has been used.");for(var a in t){if("storeName"===a&&(t[a]=t[a].replace(/\W/g,"_")),"version"===a&&"number"!=typeof t[a])return new Error("Database version must be a number.");this._config[a]=t[a]}return!("driver"in t)||!t.driver||this.setDriver(this._config.driver)}return"string"==typeof t?this._config[t]:this._config},e.prototype.defineDriver=function(t,a,i){var n=new h(function(s,c){try{var f=t._driver,l=new Error("Custom driver not compliant; see https://mozilla.github.io/localForage/#definedriver");if(!t._driver)return void c(l);for(var v=Pe.concat("_initStorage"),g=0,T=v.length;g<T;g++){var I=v[g];if((!Rt(Ce,I)||t[I])&&"function"!=typeof t[I])return void c(l)}!function(){for(var De=function(Pt){return function(){var Bt=new Error("Method "+Pt+" is not implemented by the current driver"),Ke=h.reject(Bt);return b(Ke,arguments[arguments.length-1]),Ke}},Ue=0,kt=Ce.length;Ue<kt;Ue++){var Fe=Ce[Ue];t[Fe]||(t[Fe]=De(Fe))}}();var Z=function(De){Se[f]&&console.info("Redefining LocalForage driver: "+f),Se[f]=t,Xe[f]=De,s()};"_support"in t?t._support&&"function"==typeof t._support?t._support().then(Z,c):Z(!!t._support):Z(!0)}catch(oe){c(oe)}});return F(n,a,i),n},e.prototype.driver=function(){return this._driver||null},e.prototype.getDriver=function(t,a,i){var n=Se[t]?h.resolve(Se[t]):h.reject(new Error("Driver not found."));return F(n,a,i),n},e.prototype.getSerializer=function(t){var a=h.resolve(ke);return F(a,t),a},e.prototype.ready=function(t){var a=this,i=a._driverSet.then(function(){return null===a._ready&&(a._ready=a._initDriver()),a._ready});return F(i,t,t),i},e.prototype.setDriver=function(t,a,i){var n=this;Ve(t)||(t=[t]);var s=this._getSupportedDrivers(t);function c(){n._config.driver=n.driver()}function f(g){return n._extend(g),c(),n._ready=n._initStorage(n._config),n._ready}var v=null!==this._driverSet?this._driverSet.catch(function(){return h.resolve()}):h.resolve();return this._driverSet=v.then(function(){var g=s[0];return n._dbInfo=null,n._ready=null,n.getDriver(g).then(function(T){n._driver=T._driver,c(),n._wrapLibraryMethodsWithReady(),n._initDriver=function l(g){return function(){var T=0;return function I(){for(;T<g.length;){var E=g[T];return T++,n._dbInfo=null,n._ready=null,n.getDriver(E).then(f).catch(I)}c();var Y=new Error("No available storage method found.");return n._driverSet=h.reject(Y),n._driverSet}()}}(s)})}).catch(function(){c();var g=new Error("No available storage method found.");return n._driverSet=h.reject(g),n._driverSet}),F(this._driverSet,a,i),this._driverSet},e.prototype.supports=function(t){return!!Xe[t]},e.prototype._extend=function(t){Be(this,t)},e.prototype._getSupportedDrivers=function(t){for(var a=[],i=0,n=t.length;i<n;i++){var s=t[i];this.supports(s)&&a.push(s)}return a},e.prototype._wrapLibraryMethodsWithReady=function(){for(var t=0,a=Pe.length;t<a;t++)Nt(this,Pe[t])},e.prototype.createInstance=function(t){return new e(t)},e}(),Lt=new Ot;re.exports=Lt},{3:3}]},{},[4])(4)}}]);